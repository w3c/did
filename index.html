<!DOCTYPE html>
<html>
<head>
  <title>
    Decentralized Identifiers (DIDs) v1.0
  </title>
  <meta content='text/html; charset=utf-8' http-equiv='Content-Type'><!--
    === NOTA BENE ===
    For the three scripts below, if your spec resides on dev.w3 you can check
    them out in the same tree and use relative links so that they'll work
    offline.
  -->

  <script class='remove'
    src='https://www.w3.org/Tools/respec/respec-w3c-common'>
  </script><!--script src='./respec-w3c-common.js' class='remove'></script-->

  <script class='remove' src="./common.js">
  </script>
  <script class="remove" type="text/javascript">
  var respecConfig = {
        wgPublicList: "public-did-wg",
        wgPatentURI:  "https://www.w3.org/2004/01/pp-impl/117488/status",
        wg: "Decentralized Identifier Working Group",
        wgURI: "https://www.w3.org/2019/did-wg/",

    // specification status (e.g., WD, LCWD, NOTE, etc.). If in doubt use ED.
    specStatus: "WD",

    // the specification's short name, as in http://www.w3.org/TR/short-name/
    shortName: "did-core",


    edDraftURI: "https://w3c.github.io/did-core/",

    // subtitle
    subtitle: "Core architecture, data model, and representations",

    // if you wish the publication date to be other than today, set this
    //publishDate:  "2019-11-07",

    // if there is a previously published draft, uncomment this and set its
    // YYYY-MM-DD date and its maturity status
    previousPublishDate:  "2019-12-09",
    previousMaturity:  "WD",

    // automatically allow term pluralization
    pluralize: true,

    // extend the bibliography entries
    localBiblio: ccg.localBiblio,
    xref: "web-platform",
    github: {
            repoURL: "https://github.com/w3c/did-core/",
            branch: "master"
    },
    includePermalinks: false,


    // editors, add as many as you like
    // only "name" is required
    editors: [{
        name: "Drummond Reed",
        url: "https://www.linkedin.com/in/drummondreed/",
        company: "Evernym",
        companyURL: "https://www.evernym.com/",
        w3cid: 3096
      },
      {
        name: "Manu Sporny",
        url: "http://manu.sporny.org/",
        company: "Digital Bazaar",
        companyURL: "https://digitalbazaar.com/",
        w3cid: 41758
      },
      {
        name: "Markus Sabadello",
        url: "https://www.linkedin.com/in/markus-sabadello-353a0821",
        company: "Danube Tech",
        companyURL: "https://danubetech.com/",
        w3cid: 46729
      }
    ],

    // authors, add as many as you like.
    // This is optional, uncomment if you have authors as well as editors.
    // only "name" is required. Same format as editors.
    authors: [{
        name: "Drummond Reed",
        url: "https://www.linkedin.com/in/drummondreed/",
        company: "Evernym",
        companyURL: "https://www.evernym.com/",
        w3cid: 3096
      },
      {
        name: "Manu Sporny",
        url: "http://manu.sporny.org/",
        company: "Digital Bazaar",
        companyURL: "https://digitalbazaar.com/",
        w3cid: 41758
      },
      {
        name: "Dave Longley",
        url: "",
        company: "Digital Bazaar",
        companyURL: "https://digitalbazaar.com/",
        w3cid: 48025
      },
      {
        name: "Christopher Allen",
        url: "https://www.linkedin.com/in/christophera",
        company: "Blockchain Commons",
        companyURL: "https://www.BlockchainCommons.com",
        w3cid: 85560
      },
      {
        name: "Ryan Grant",
        url: "",
        company: "",
        companyURL: ""
      },
      {
        name: "Markus Sabadello",
        url: "https://www.linkedin.com/in/markus-sabadello-353a0821",
        company: "Danube Tech",
        companyURL: "https://danubetech.com/",
        w3cid: 46729
      },
      {
        name: "Jonathan Holt, DO, MS",
        url: "https://www.linkedin.com/in/jonathan-holt-do-ms",
        company: "ConsenSys Health",
        companyURL: "https://www.consensyshealth.com",
        w3cid: 95341
      }
    ]
    };
  </script>
  <style>
  pre .highlight {
    font-weight: bold;
    color: green;
  }
  pre .comment {
    color: SteelBlue;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
  }
  </style>
</head>
<body data-cite="infra rfc3986">
  <section id='abstract'>

    <p>
<a>Decentralized identifiers</a> (DIDs) are a new type of identifier that
enables verifiable, decentralized digital identity. A <a>DID</a> identifies any
subject (e.g., a person, organization, thing, data model, abstract entity, etc.)
that the controller of the <a>DID</a> decides that it identifies.

In contrast to typical, federated identifiers, DIDs have been designed
so that they may be decoupled from centralized registries, identity providers,
and certificate authorities. Specifically, while other parties might be used
to help enable the discovery of information related to a <a>DID</a>,
the design enables the controller of a <a>DID</a> to prove control over it
without requiring permission from any other party.

<a>DID</a>s are URLs that associate
a <a>DID subject</a> with a <a>DID document</a> allowing trustable interactions
associated with that subject. Each <a>DID document</a> can express cryptographic
material, verification methods, or <a>service endpoints</a>, which provide a set
of mechanisms enabling a <a>DID controller</a> to prove control of the
<a>DID</a>. <a>Service endpoints</a> enable trusted interactions associated with
the <a>DID subject</a>. A <a>DID document</a> might contain semantics about the
subject that it identifies. A <a>DID document</a> might contain the <a>DID
subject</a> itself (e.g. a data model).
    </p>
    <p>
This document specifies a common data model, a URL format, and a set of
operations for <a>DIDs</a>, <a>DID documents</a>, and <a>DID methods</a>.
    </p>
  </section>

  <section id='sotd'>

    <p>
This specification is under active development and implementers are advised
against implementing the specification unless they are directly involved with
the W3C DID Working Group. There are use cases [[?DID-USE-CASES]] in active
development that establish requirements for this document.
    </p>

    <p>
At present, there exist
<a href="https://w3c-ccg.github.io/did-method-registry/#the-registry">40
experimental implementations</a> and a preliminary
<a href="https://github.com/w3c-ccg/did-test-suite/">test suite</a>
that will eventually determine whether or not implementations are conformant.
Readers are advised that Appendix <a href="#current-issues"></a> contains a
list of concerns and proposed changes that will most likely result in
alterations to this specification.
    </p>

    <p>
Comments regarding this document are welcome. Please file issues
directly on <a href="https://github.com/w3c/did-core/issues/">GitHub</a>,
or send them
to <a href="mailto:public-did-wg@w3.org">public-did-wg@w3.org</a> (
<a href="mailto:public-did-wg-request@w3.org?subject=subscribe">subscribe</a>,
<a href="https://lists.w3.org/Archives/Public/public-did-wg/">archives</a>).
    </p>

    <p>
Portions of the work on this specification have been funded by the United States
Department of Homeland Security's Science and Technology Directorate under
contracts HSHQDC-16-R00012-H-SB2016-1-002 and HSHQDC-17-C-00019. The content of
this specification does not necessarily reflect the position or the policy of
the U.S. Government and no official endorsement should be inferred.
    </p>

    <p>
Work on this specification has also been supported by the Rebooting the Web of
Trust community facilitated by Christopher Allen, Shannon Appelcline, Kiara
Robles, Brian Weller, Betty Dhamers, Kaliya Young, Kim Hamilton Duffy, Manu
Sporny, Drummond Reed, Joe Andrieu, and Heather Vescent.
    </p>
  </section>

  <section class="informative">
    <h1>
Introduction
    </h1>
    <p>
As individuals and organizations, many of us use globally unique identifiers in
a wide variety of contexts. They serve as communications addresses (telephone
numbers, email addresses, usernames on social media), ID numbers (for passports,
drivers licenses, tax IDs, health insurance), and product identifiers (serial
numbers, barcodes, RFIDs). Resources on the Internet are identified by globally
unique identifiers in the form of <abbr title="Media Access Control">MAC</abbr>
addresses; URIs (Uniform Resource Identifiers) are used for resources on the Web
and each web page you view in a browser has a globally unique URL (Uniform
Resource Locator).
    </p>
    <p>
The vast majority of these globally unique identifiers are not under our
control. They are issued by external authorities that decide who or what they
identify and when they can be revoked. They are useful only in certain contexts
and recognized only by certain bodies (not of our choosing). They may disappear
or cease to be valid with the failure of an organization. They may unnecessarily
reveal personal information. And in many cases they can be fraudulently
replicated and asserted by a malicious third-party ("identity theft").
    </p>
    <p>
The Decentralized Identifiers (DIDs) defined in this specification are a new
type of globally unique identifier designed to enable individuals and
organizations to generate our own identifiers using systems we trust, and to
prove control of those identifiers (authenticate) using cryptographic proofs
(for example, digital signatures, privacy-preserving biometric protocols, and so
on).
    </p>
    <p>
Because we control the generation and assertion of these identifiers, each of us
can have as many DIDs as we need to respect our desired separation of
identities, personas, and contexts (in the everyday sense of these words). We
can scope the use of these identifiers to the most appropriate contexts. We can
interact with other people, institutions or systems that require us to identify
ourselves (or things we control) while maintaining control over how much
personal or private data should be revealed, and without depending on a central
authority to guarantee the continued existence of the identifier.
    </p>
    <p>
This specification does not require any particular technology or cryptography to
underpin the generation, persistence, resolution or interpretation of DIDs.
Rather, it defines: a) the generic syntax for all DIDs, and b) the generic
requirements for performing the four basic CRUD operations (create, read,
update, deactivate) on the metadata associated with a DID (called the DID
document).
    </p>
    <p>
This enables implementers to design specific types of DIDs to work with the
computing infrastructure they trust (e.g., blockchain, distributed ledger,
decentralized file system, distributed database, peer-to-peer network). The
specification for a specific type of DID is called a DID method. Implementers of
applications or systems using DIDs can choose to support the DID methods most
appropriate for their particular use cases.
    </p>
    <p>
This specification is for:
    </p>
    <ul>
      <li>
Developers who want to enable users of their system to generate and assert their
own identifiers (producers of DIDs);
      </li>
      <li>
Developers who want to enable their systems to accept user-controlled
identifiers (consumers of DIDs);
      </li>
      <li>
Developers who wish to enable the use of DIDs with particular computing
infrastructure (DID method developers).
      </li>
    </ul>

    <p class="note" title="Diversity of DID systems">
DID methods can also be developed for identifiers registered in federated or
centralized identity management systems. Indeed, almost all types of identifier
systems can add support for DIDs. This creates an interoperability bridge
between the worlds of centralized, federated, and decentralized identifiers.
    </p>

    <section class="informative">
      <h2>
A Simple Example
      </h2>

      <p>
A <a>DID</a> is a simple text string consisting of three parts, the:
      </p>
        <ul>
          <li>
URL scheme identifier (<code>did</code>)
          </li>
          <li>
Identifier for the <a>DID method</a>
          </li>
          <li>
DID method-specific identifier.
          </li>
        </ul>

      <pre class="example nohighlight"
      title="A simple example of a decentralized identifier (DID)">
did:example:123456789abcdefghi
      </pre>

      <p>
The example <a>DID</a> above resolves to a <a>DID document</a>. A <a>DID
document</a> contains information associated with the <a>DID</a>, such as ways
to cryptographically authenticate the <a>DID controller</a>, as
well as services that can be used to interact with the <a>DID subject</a>.
      </p>

      <pre class="example nohighlight" title="Minimal self-managed DID document">
{
  "@context": "https://www.w3.org/ns/did/v1",
  "id": "did:example:123456789abcdefghi",
  "authentication": [{
    <span class="comment">// used to authenticate as did:...fghi</span>
    "id": "did:example:123456789abcdefghi#keys-1",
    "type": "Ed25519VerificationKey2018",
    "controller": "did:example:123456789abcdefghi",
    "publicKeyBase58": "H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV"
  }],
  "service": [{
    <span class="comment">// used to retrieve Verifiable Credentials associated with the DID</span>
    "id":"did:example:123456789abcdefghi#vcs",
    "type": "VerifiableCredentialService",
    "serviceEndpoint": "https://example.com/vc/"
  }]
}
      </pre>
    </section>

    <section class="informative">
      <h2>
Design Goals
      </h2>

      <p>
<a>Decentralized Identifiers</a> are a component of larger systems, such as
the Verifiable Credentials ecosystem [[VC-DATA-MODEL]], which drove the design
goals for this specification. This section summarizes the primary design goals
for this specification.
      </p>

      <table class="simple">
        <thead>
          <tr>
            <th>
Goal
            </th>
            <th>
Description
            </th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td>
Decentralization
            </td>
            <td>
Eliminate the requirement for centralized authorities or single point
failure in identifier management, including the registration of globally unique
identifiers, public verification keys, <a>service endpoints</a>, and other
metadata.
            </td>
          </tr>

          <tr>
            <td>
Control
            </td>
            <td>
Give entities, both human and non-human, the power to directly control their
digital identifiers without the need to rely on external authorities.
            </td>
          </tr>

          <tr>
            <td>
Privacy
            </td>
            <td>
Enable entities to control the privacy of their information, including minimal,
selective, and progressive disclosure of attributes or other data.
            </td>
          </tr>

          <tr>
            <td>
Security
            </td>
            <td>
Enable sufficient security for relying parties to depend on <a>DID documents</a>
for their required level of assurance.
            </td>
          </tr>

          <tr>
            <td>
Proof-based
            </td>
            <td>
Enable <a>DID controllers</a> to provide cryptographic proof when interacting
with other entities.
            </td>
          </tr>

          <tr>
            <td>
Discoverability
            </td>
            <td>
Make it possible for entities to discover <a>DIDs</a> for other entities, to
learn more about or interact with those entities.
            </td>
          </tr>

          <tr>
            <td>
Interoperability
            </td>
            <td>
Use interoperable standards so <a>DID</a> infrastructure can make use of
existing tools and software libraries designed for interoperability.
            </td>
          </tr>

          <tr>
            <td>
Portability
            </td>
            <td>
Be system- and network-independent and enable entities to use their digital
identifiers with any system that supports <a>DIDs</a> and <a>DID methods</a>.
            </td>
          </tr>

          <tr>
            <td>
Simplicity
            </td>
            <td>
Favor a reduced set of simple features to make the technology easier to
understand, implement, and deploy.
            </td>
          </tr>

          <tr>
            <td>
Extensibility
            </td>
            <td>
Where possible, enable extensibility provided it does not greatly hinder
interoperability, portability, or simplicity.
            </td>
          </tr>
        </tbody>
      </table>
    </section>

    <section>
      <h2>
Architecture Overview
      </h2>

      <p>
This section provides a basic understanding of the major elements of DID
architecture. Formal definitions of terms are provided in
<a href="#terminology"></a>.
      </p>

      <figure id="architecture">
          <img style="margin: auto; display: block; width: 75%;"
            src="diagrams/did_architecture_overview.svg" alt="
Diagram showing that DIDs are recorded on a Verifiable Data Registry; DIDs
resolve to DID documents; DIDs identify DID subjects; a DID controller can
modify a DID document; a DID method generates a DID; a DID method instructs a
DID resolver.
          " >
          <figcaption>
The basic components of DID architecture.
          </figcaption>
      </figure>

      <dl>
        <dt>
DIDs and DID URLs
        </dt>
        <dd>
A <a>DID</a>, or Decentralized Identifier, is a URI composed of three parts: the
scheme "did:", a method identifier, and a unique, method-specific identifier
generated by the <a>DID method</a>. DIDs are resolvable to <a>DID documents</a>.
A <a>DID URL</a> extends the syntax of a basic DID to incorporate other standard
URI components (path, query, fragment) in order to locate a particular
resource&mdash;for example, a public key inside a <a>DID document</a>, or a
resource available external to the <a>DID document</a>.
        </dd>

        <dt>
DID Subjects
        </dt>
        <dd>
The subject of a <a>DID</a> is, by definition, the entity identified by the
<a>DID</a>. The <a>DID subject</a> may also be the <a>DID controller</a>.
Anything can be the subject of a DID: person, group, organization, physical
thing, logical thing, etc.
        </dd>

        <dt>
DID Controllers
        </dt>
        <dd>
The <a>controller</a> of a <a>DID</a> is the entity (person, organization, or
autonomous software) that has the capability&mdash;as defined by a <a>DID
method</a>&mdash;to make changes to a <a>DID document</a>. This capability is
typically asserted by the control of a set of cryptographic keys used by
software acting on behalf of the controller, though it may also be asserted via
other mechanisms. Note that a DID may have more than one controller, and the
controller(s) may include the <a>DID subject</a>.
        </dd>

        <dt>
Verifiable Data Registries
        </dt>
        <dd>
In order to be resolvable to <a>DID documents</a>, <a>DIDs</a> are typically
recorded on an underlying system or network of some kind. Regardless of the
specific technology used, any such system that supports recording DIDs and
returning data necessary to produce <a>DID documents</a> is called a
<a>verifiable data registry</a>. Examples include distributed ledgers,
decentralized file systems, databases of any kind, peer-to-peer networks, and
other forms of trusted data storage.
        </dd>

        <dt>
DID documents
        </dt>
        <dd>
<a>DID documents</a> contain metadata associated with a <a>DID</a>. They
typically express verification methods (such as public keys) and services
relevant to interactions with the DID subject. A DID document is serialized
according to a particular syntax (see <a href="#core-representations"></a>). The
<a>DID</a> itself is the value of the `id` property. The generic properties
supported in a DID document are specified in <a href="#core-properties"></a>.
The properties present in a DID document may be updated according to the
applicable operations outlined in <a href="#methods"></a>.
        </dd>

        <dt>
DID Methods
        </dt>
        <dd>
<a>DID methods</a> are the mechanism by which a particular type of <a>DID</a>
and its associated <a>DID document</a> are created, resolved, updated, and
deactivated using a particular <a>verifiable data registry</a>. <a>DID
methods</a> are defined using separate DID method specifications (see
<a href="#methods"></a>).

          <p class="note">
Conceptually, the relationship between this specification and a <a>DID
method</a> specification is similar to the relationship between the IETF generic
<a>URI</a> specification ([[RFC3986]]) and a specific <a>URI</a> scheme
([[IANA-URI-SCHEMES]] (such as the http: and https: schemes specified in
[[RFC7230]]). It is also similar to the relationship between the IETF generic
URN specification ([[RFC8141]]) and a specific URN namespace definition, (such
as the <a>UUID</a> URN namespace defined in [[RFC4122]]). The difference is that
a DID method specification, as well as defining a specific DID scheme, also
specifies the methods creating, resolving, updating, and deactivating
<a>DIDs</a> and <a>DID documents</a> using a specific type of <a>verifiable data
registry</a>.
          </p>
        </dd>

        <dt>
DID resolvers and DID resolution
        </dt>
        <dd>
A <a>DID resolver</a> is a software and/or hardware component that takes a
<a>DID</a> (and associated options) as input and produces a conforming <a>DID
document</a> (and associated metadata) as output. This process is called <a>DID
resolution</a>. The inputs and outputs of the DID resolution process are defined
in <a href="#resolution"></a>. The specific steps for resolving a specific type
of DID are defined by the relevant <a>DID method</a> specification. Additional
considerations for implementing a DID resolver are discussed in
[[DID-RESOLUTION]].
        </dd>
        <dt>
DID URL dereferencers and DID URL dereferencing
        </dt>
        <dd>
A <a>DID URL</a> dereferencer is a software and/or hardware component that takes
a DID URL (and associated options) as input and produces a resource (and
associated metadata) as output. This process is called DID URL dereferencing.
The inputs and outputs of the DID URL dereferencing process are defined in <a
href="#did-url-dereferencing"></a>. Additional considerations for implementing a
DID URL dereferencer are discussed in [[DID-RESOLUTION]].
        </dd>
      </dl>

    </section>

    <section id="conformance">

      <p>
This document contains examples that contain JSON, CBOR, and JSON-LD content.
Some of these examples contain characters that are invalid, such as inline
comments (<code>//</code>) and the use of ellipsis (<code>...</code>) to denote
information that adds little value to the example. Implementers are cautioned to
remove this content if they desire to use the information as valid JSON, CBOR,
or JSON-LD.
      </p>

      <p>
Interoperability of implementations for DIDs and DID documents will be tested by
evaluating an implementation's ability to create and parse <a>DIDs</a> and
<a>DID documents</a> that conform to the specification. Interoperability for
producers and consumers of <a>DIDs</a> and <a>DID documents</a> is provided by
ensuring the <a>DIDs</a> and <a>DID documents</a> conform. Interoperability for
<a>DID method</a> specifications is provided by the details in each DID method
specification. It is understood that, in the same way that a web browser is not
required to implement all known URI schemes, conformant software that works with
DIDs is not required to implement all known DID methods (however, all
implementations of a given DID method must be interoperable for that method).
      </p>

     <p>
A <dfn>conforming DID</dfn> is any concrete expression of the rules specified in
Section <a href="#identifier"></a> and MUST comply with relevant normative
statements in that section.
     </p>

      <p>
A <dfn>conforming DID document</dfn> is any concrete expression of the data
model described in this specification and MUST comply with the relevant
normative statements in Sections <a href="#data-model"></a> and  <a
href="#core-properties"></a>. A serialization format for the conforming document
MUST be deterministic, bi-directional, and lossless as described in Section <a
href="#core-representations"></a>. The <a>conforming DID document</a> MAY be
transmitted or stored in any such serialization format.
      </p>

      <p>
A <dfn>conforming DID method</dfn> is any specification that complies with the
relevant normative statements in Section <a href="#methods"></a>.
      </p>

      <p>
A <dfn>conforming producer</dfn> is any algorithm realized as software and/or
hardware and conforms to this specification if it generates <a>conforming
DID</a>s or <a>conforming DID Document</a>s. A conforming producer MUST
NOT produce non-conforming <a>DIDs</a> or <a>DID documents</a>.
      </p>

      <p>
A <dfn>conforming consumer</dfn> is any algorithm realized as software and/or
hardware and conforms to this specification if it consumes <a>conforming
DID</a>s or <a>conforming DID document</a>s. A conforming consumer MUST
produce errors when consuming non-conforming <a>DIDs</a> or <a>DID documents</a>.
      </p>

    </section>

  </section>

  <section class="informative">
    <h2>
Terminology
    </h2>

    <div data-include="terms.html" data-oninclude="restrictReferences">
    </div>

  </section>

  <section>
    <h2>Identifier</h2>
    <p>
This section describes the formal syntax for DIDs and DID URLs. The term
"generic" is used to differentiate the syntax defined here from syntax defined
by <em>specific</em> <a>DID methods</a> in their respective specifications.
    </p>

    <section class="normative">
      <h3>DID Syntax</h3>

      <p>
The generic <a>DID scheme</a> is a URI scheme conformant with [[!RFC3986]].
      </p>

      <p>
The <a>DID scheme</a> name MUST be an
<a data-lt="ascii lowercase">ASCII lowercase string</a>.
      </p>
      <p>
The <a>DID method</a> name MUST be an
<a data-lt="ascii lowercase">ASCII lowercase string</a>.
      </p>

      <p>
The following is the ABNF definition using the syntax in [[!RFC5234]], which
defines <code>ALPHA</code> and <code>DIGIT</code>. All other rule names not
defined in this ABNF are defined in [[RFC3986]].
      </p>

      <pre class="nohighlight">
did                = "did:" method-name ":" method-specific-id
method-name        = 1*method-char
method-char        = %x61-7A / DIGIT
method-specific-id = *( *idchar ":" ) 1*idchar
idchar             = ALPHA / DIGIT / "." / "-" / "_"
      </pre>

      <p>
A <a>DID method</a> specification MUST further restrict the generic <a>DID</a>
syntax by defining its own <code>method-name</code> and its own
<code>method-specific-id</code> syntax. Case sensitivity and normalization of
the value of the <code>method-specific-id</code> rule MUST be defined by the
governing <a>DID method</a> specification. For more information, see Section
<a href="#methods"></a>.
      </p>

      <div class="note" title="Persistence">
        <p>
  A <a>DID</a> is expected to be persistent and immutable. That is, a <a>DID</a>
  is bound exclusively and permanently to its one and only subject. Even after a
  <a>DID</a> is deactivated, it is intended that it never be repurposed.
        </p>
        <p>
Ideally, a <a>DID</a> would be a completely abstract decentralized identifier
(like a <a>UUID</a>) that could be bound to multiple underlying <a>verifiable
data registries</a> over time, thus maintaining its persistence independent of
any particular system. However, registering the same identifier on multiple
<a>verifiable data registries</a> makes it extremely difficult to identify the
authoritative version of a <a>DID document</a> if the contents diverge
between the different <a>verifiable data registries</a>. It also greatly
increases implementation complexity for developers.
        </p>
        <p>
To avoid these issues, developers should refer to the Decentralized
Characteristics Rubric [[?DID-RUBRIC]] to decide which <a>DID method</a> best
addresses the needs of the use case.
        </p>
      </div>

    </section>

    <section class="normative">
      <h3>DID URL Syntax</h3>

      <p>
A <a>DID URL</a> always identifies a <a>resource</a> to be located. It can be
used, for example, to identify a specific part of a <a>DID document</a>.
      </p>

      <p>
This following is the ABNF definition using the syntax in [[!RFC5324]]. It
builds on the <code>did</code> scheme defined in <a href="#did-syntax"></a>. The
<a data-cite="!rfc3986#section-3.3"><code>path-abempty</code></a> and  <a
data-cite="!rfc3986#section-3.5"><code>fragment</code></a> components are
identical to the ABNF rules defined in [[!RFC3986]], and the
<code>did-query</code> component is derived from the  <a
data-cite="!rfc3986#section-3.4"><code>query</code></a> ABNF rule.
      </p>

      <pre class="nohighlight">
did-url            = did path-abempty [ "?" did-query ]
                     [ "#" fragment ]
did-query          = param *( "&" param )
param              = param-name "=" param-value
param-name         = 1*pchar
param-value        = *pchar
      </pre>

      <p class="note">
This specification reserves the semicolon (<code>;</code>) character for
possible future use as a sub-delimiter for parameters as described in
[[?MATRIX-URIS]].
      </p>

      <section>
        <h2>Generic DID URL Parameters</h2>

        <p>
The <a>DID URL</a> syntax supports a simple, generalized format for parameters
based on the query component (See <a href="#query"></a>). The ABNF above
specifies the basic syntax (the <code>param</code> rule) but does not specify
any concrete parameter names.
        </p>
        <p>
Some generic DID parameter names (for example, for service selection) are
completely independent of any specific <a>DID method</a> and MUST always
function the same way for all <a>DIDs</a>. Other DID parameter names (for
example, for versioning) MAY be supported by certain <a>DID methods</a>, but
MUST operate uniformly across those <a>DID methods</a> that do support them.
        </p>
        <p>
Parameter names that are completely method-specific are described in Section
<a href="#method-specific-did-url-parameters"></a>.
        </p>
        <p>
The following table defines a set of generic DID parameter names.
        </p>

        <table class="simple">
          <thead>
            <tr>
              <th>
Generic DID Parameter Name
              </th>
              <th>
Description
              </th>
            </tr>
          </thead>

          <tbody>
            <tr>
              <td>
<code>hl</code>
              </td>
              <td>
A resource hash of the <a>DID document</a> to add integrity protection, as
specified in [[?HASHLINK]].
              </td>
            </tr>
            <tr>
              <td>
<code>service</code>
              </td>
              <td>
Identifies a service from the <a>DID document</a> by service ID.
              </td>
            </tr>
            <tr>
              <td>
<code>version-id</code>
              </td>
              <td>
Identifies a specific version of a <a>DID document</a> to be resolved (the
version ID could be sequential, or a <a>UUID</a>, or method-specific). Note that
this parameter might not be supported by all <a>DID methods</a>.
              </td>
            </tr>

            <tr>
              <td>
<code>version-time</code>
              </td>
              <td>
Identifies a certain version timestamp of a <a>DID document</a> to be resolved.
That is, the <a>DID document</a> that was valid for a <a>DID</a> at a certain
time. Note that this parameter might not be supported by all <a>DID methods</a>.
              </td>
            </tr>
          </tbody>
        </table>

        <p>
Additional considerations for processing these parameters are discussed in
[[?DID-RESOLUTION]].
        </p>

        <p>
Two example <a>DID URLs</a> using the <code>service</code> and
<code>version-time</code> generic DID parameters are shown below.
        </p>

        <pre class="example nohighlight" title="A DID URL with a 'service' DID parameter">
did:foo:21tDAKCERh95uGgKbJNHYp?service=agent
        </pre>

        <pre class="example nohighlight" title="A DID URL with a 'version-time' DID parameter">
did:foo:21tDAKCERh95uGgKbJNHYp?version-time=2002-10-10T17:00:00Z
        </pre>

        <p>
Adding a DID parameter to a <a>DID URL</a> means that the parameter becomes part
of an identifier for a <a>resource</a> (the <a>DID document</a> or other).
Alternatively, the <a>DID resolution</a> and the <a>DID URL dereferencing</a>
functions can also be influenced by passing input metadata to a <a>DID
resolver</a> that are not part of the DID URL. (See <a
href="#metadata-structure"></a>). Such options could for example control caching
or the desired encoding of a resolution result. This is comparable to HTTP,
where certain parameters could either be included in an HTTP URL, or
alternatively passed as HTTP headers during the dereferencing process. The
important distinction is that DID parameters that are part of the <a>DID URL</a>
should be used to specify <i>what <a>resource</a> is being identified</i>,
whereas <a>DID resolution</a> options that are not part of the <a>DID URL</a>
should be use to control <i>how that <a>resource</a> is resolved or
dereferenced</i>.
        </p>

        <p>
DID parameters MAY be used if there is a clear use case where the parameter
needs to be part of a URI that can be used as a link, or as a <a>resource</a> in
RDF / JSON-LD documents.
        </p>

        <p>
DID parameters SHOULD NOT be used if there are already other, equivalent ways of
constructing URIs that fulfill the same purpose (for example, using other
syntactical constructs such as URI query strings or URI fragments).
        </p>

        <p>
DID parameters SHOULD NOT be used if the same functionality can be expressed by
passing options to a <a>DID resolver</a>, and if there is no need to construct a
URI for use as a link, or as a <a>resource</a> in RDF / JSON-LD documents.
        </p>

      </section>

      <section>
        <h2>Method-Specific DID URL Parameters</h2>

        <p>
A <a>DID method</a> specification MAY specify additional method-specific
parameter names. A method-specific parameter name MUST be prefixed by the method
name, as defined by the <code>method-name</code> rule.
        </p>

        <p>
For example, if the method <code>did:foo:</code> defines the parameter bar, the
parameter name must be <code>foo:bar</code>. An example <a>DID URL</a> using
this method and this method-specific parameter would be as shown below.
        </p>

        <pre class="example nohighlight">
did:foo:21tDAKCERh95uGgKbJNHYp?foo:bar=high
        </pre>

        <p>
A method-specific parameter name defined by one <a>DID method</a> MAY be used by
other <a>DID methods</a>.
        </p>

        <pre class="example nohighlight">
did:example:21tDAKCERh95uGgKbJNHYp?foo:bar=low
        </pre>

        <p>
Method-specific parameter names MAY be combined with generic parameter names in
any order.
        </p>

        <pre class="example nohighlight">
did:example:21tDAKCERh95uGgKbJNHYp?service=agent&amp;foo:bar=high
        </pre>

        <p>
Both <a>DID method</a> namespaces and method-specific parameter namespaces MAY
include colons, so they might be partitioned hierarchically, as defined by a
<a>DID method</a> specification. The following example <a>DID URL</a>
illustrates both.
        </p>

        <pre class="example nohighlight">
did:foo:baz:21tDAKCERh95uGgKbJNHYp?foo:baz:hex=b612
        </pre>

        <p class="issue" data-number="36">
Review what exactly we want to say about method-specific parameters
defined by one method but used in a <a>DID URL</a> with a different method.
Also discuss hierarchical method namespaces in DID parameter names.
        </p>

      </section>

      <section>
        <h2>Path</h2>

        <p>
A <a>DID path</a> is identical to a generic URI path and MUST conform to the
<code>path-abempty</code> ABNF rule in [[!RFC3986]]. A <a>DID path</a> SHOULD be
used to address <a>resources</a> available through a <a>service endpoint</a>.
For more information, see Section <a href="#service-endpoints"></a>.
        </p>

        <p>
A <a>DID method</a> specification MAY specify ABNF rules for <a>DID paths</a>
that are more restrictive than the generic rules in this section.
        </p>

        <pre class="example nohighlight">
did:example:123456/path
        </pre>
      </section>

      <section>
        <h2>Query</h2>

        <p>
A <a>DID query</a> is derived from a generic URI query and MUST conform to the
<code>did-query</code> ABNF rule in Section <a href="#did-url-syntax">
</a>. If a <a>DID query</a> is present, it MUST be used
as described in Sections <a href="#generic-did-url-parameters"></a> and
<a href="#method-specific-did-url-parameters"></a>.
        </p>

        <p>
A <a>DID method</a> specification MAY specify ABNF rules for <a>DID queries</a>
that are more restrictive than the generic rules in this section.
        </p>

        <pre class="example nohighlight">
did:example:123456?query=true
        </pre>
      </section>

      <section>
        <h2>Fragment</h2>

        <p>
A <a>DID fragment</a> is used as method-independent reference into the <a>DID
document</a> to identify a component of the document (for example, a unique
<a>public key description</a> or <a>service endpoint</a>). <a>DID fragment</a>
syntax and semantics are identical to a generic URI fragment and  MUST conform
to <a data-cite="RFC3986#section-3.5">RFC&nbsp;3986, section 3.5</a>. To
dereference a <a>DID fragment</a>, the complete <a>DID URL</a> including the
<a>DID fragment</a> MUST be used as input to the <a>DID URL dereferencing</a>
function for the target component in the <a>DID document</a> object. For more
information, see <a href="#did-url-dereferencing"></a>.
        </p>

        <p>
A <a>DID method</a> specification MAY specify ABNF rules for <a>DID fragments</a>
that are more restrictive than the generic rules in this section.
        </p>

        <pre class="example nohighlight">
did:example:123456#public-key-1
        </pre>

        <p>
In order to maximize interoperability, implementers are urged to ensure that
<a>DID fragments</a> are interpreted in the same way across representations (as
described in <a href="#core-representations"></a>). For example, while
JSON Pointer [[?RFC6901]] can be used in a <a>DID fragment</a>, it will not
be interpreted in the same way across representations.
        </p>

        <p>
Additional semantics for fragment identifiers, which are compatible with and
layered upon the semantics in this section, are described for JSON-LD
representations in Section <a href="#application-did-ld-json"></a>.
        </p>

      </section>

      <section>
        <h2>Relative DID URLs</h2>

        <p>
A relative DID URL is any URL value in a <a>DID document</a> that does not start
with <code>did:&lt;method-name>:&lt;method-specific-id></code>. More
specifically, it is any URL value that does not start with the ABNF defined  in
Section <a href="#did-syntax"></a>. The contents of the URL typically
refers to a <a>resource</a> in the same <a>DID document</a>. Relative DID URLs
MAY contain relative path components, query parameters, and fragment
identifiers.
        </p>

        <p>
When resolving a relative DID URL reference, the algorithm specified in <a
data-cite="RFC3986#section-5">RFC3986 Section 5: Reference Resolution</a>  MUST
be used. The <strong>base URI</strong> value is the <a>DID</a> that is
associated with the <a>DID subject</a>, see Section <a href="#did-subject"></a>.
The <strong>scheme</strong> is <code>did</code>. The <strong>authority</strong>
is a combination of <code>&lt;method-name>:&lt;method-specific-id></code>, and
the <strong>path</strong>, <strong>query</strong>, and <strong>fragment</strong>
values are those defined in Section <a href="#path"></a>, Section <a
href="#query"></a>, and Section <a href="#fragment"></a>, respectively.
        </p>

        <p>
Relative DID URLs are often used to identify <a>verification methods</a> and
<a>services</a> in a DID Document without having to use absolute URLs, which
tend to be more verbose than necessary.
        </p>

        <pre class="example nohighlight"
          title="An example of a relative DID URL">
{
  "@context": "https://www.w3.org/ns/did/v1",
  "id": "did:example:123456789abcdefghi",
  "publicKey": [{
    "id": "did:example:123456789abcdefghi#key-1",
    "type": "Ed25519VerificationKey2018",
    "controller": "did:example:123456789abcdefghi",
    "publicKeyBase58": "H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV"
  }, ...],
  "authentication": [
<span class="comment">    // a relative DID URL used to reference a verification method above</span>
    "<span class="highlight">#key-1</span>"
  ]
}
        </pre>

        <p>
In the example above, the relative DID URL value will be transformed to an
absolute DID URL value of <code>did:example:123456789abcdefghi#key-1</code>.
        </p>
      </section>

    </section>

  </section>

  <section>
    <h1>Data Model</h1>
    <p>
This specification defines an abstract data model for <a>DID documents</a>,
independent of any specific representation. This section provides a
high-level description of the data model, a set of requirements for
representations, and a set of requirements for extensibility.
    </p>
    <section>
      <h2>Definition</h2>
      <p>
A <a>DID document</a> consists of a collection of properties, which are
name-value pairs (ie. a property name, and a property value). The
definitions of each of these properties are specified in section
<a href="#core-properties"></a>. Specific representations are defined in section
<a href="#core-representations"></a>.
      </p>
    </section>
    <section>
      <h2>Representations</h2>
      <p>
Following are the requirements for representations.
      </p>
      <ol>
        <li>
A representation MUST define an unambiguous encoding and decoding of all
property names and their associated values as defined in this specification.
This means anything you can represent in the <a>DID document</a> data model
can be represented in any compliant representation.
        </li>
        <li>
The representation MUST be associated with an IANA-registered MIME type.
        </li>
        <li>
The representation MUST define fragment processing rules for its MIME type that
are conformant with the fragment processing rules defined in section
<a href="#fragment"></a> of this specification.
        </li>
      </ol>
        <p>
The core representations are specified in section
<a href="#core-representations"></a>.
        </p>
    </section>
    <section>
      <h2>Extensibility</h2>
      <p>
The data model supports two types of extensibility.
      </p>
      <ol>
        <li>
For maximum interoperability, it is RECOMMENDED that extensions use the official
W3C DID Specification Registries mechanism [[DID-SPEC-REGISTRIES]]. The use of
this mechanism for new properties or other extensions is the only specified method
that ensures that two different representations will be able to work together.
        </li>
      <li>
Representations MAY define other extensibility mechanisms including methods for
decentralized extensions. Such extension mechanisms MUST support lossless
conversion into any other conformant representation.
      </li>
      </ol>
      <p class="note">
It is always possible for two specific implementations to agree out-of-band to
use a mutually understood extension or representation that is not recorded in
the DID Core Registries [[DID-SPEC-REGISTRIES]]; interoperability between such
implementations and the larger ecosystem will be less reliable.
      </p>
    </section>

  </section>

  <section>
    <h1>Core Properties</h1>

    <p>
A <a>DID</a> points to a <a>DID document</a>. <a>DID documents</a> are the
serialization of the data model outlined in Section <a href="#data-model"></a>.
The following sections define the properties in a <a>DID document</a>,
including whether these properties are required or optional.
    </p>

    <section>
      <h2>
Identifiers
      </h2>
      <p>
Identifiers are used in the data model to identify specific instances of people,
organizations, devices, keys, services, and things in general. Identifiers are
typically URLs, or more generally, <a>URIs</a>. Non-<a>URI</a>-based identifiers
are not advised because, while the data model supports them, they are not easy
to use with other Internet-based identifiers.
      </p>
    </section>

    <section>
      <h2>DID Subject</h2>

      <p>
The <a>DID subject</a> is denoted with the <code>id</code> property. The
<a>DID subject</a> is the entity that the <a>DID document</a> is about. That is,
it is the entity identified by the <a>DID</a> and described by the
<a>DID document</a>.
      </p>

      <p>
<a>DID documents</a> MUST include the <code>id</code> property.
      </p>

      <dl>
        <dt>id</dt>
        <dd>
The value of <code>id</code> MUST be a single valid <a>DID</a>.
        </dd>
      </dl>

      <pre class="example nohighlight">
{
  "id": "did:example:21tDAKCERh95uGgKbJNHYp"
}
      </pre>

      <p class="note">
<a>DID method</a> specifications can create intermediate representations of a
<a>DID document</a> that do not contain the <code>id</code> property, such as
when a <a>DID resolver</a> is performing <a>DID resolution</a>. However, the
fully resolved <a>DID document</a> always contains a valid <code>id</code>
property. The value of <code>id</code> in the resolved <a>DID document</a> is
expected to match the <a>DID</a> that was resolved.
      </p>
    </section>

    <section>
      <h2>Verification Methods</h2>
      <p>
A <a>DID document</a> can express <a>verification methods</a>, such as
cryptographic keys, which can be used to authenticate or authorize interactions
with the <a>DID subject</a> or associated parties. The information expressed
often includes globally unambiguous identifiers and public key material, which
can be used to verify digital signatures. For example, a public key can be
used as a verification method with respect to a digital signature; in such
usage, it verifies that the signer possessed the associated private key.
      </p>
      <p>
Verification methods might take many parameters. An example of this is a set
of five cryptographic keys from which any three are required to contribute to
a threshold signature. Methods need not be cryptographic. An example of this
might be the contact information for a biometric service provider that compares
a purported <a>DID controller</a> against a candidate biometric vector.
      </p>

      <p>
A <a>DID document</a> MAY include a <code>verificationMethod</code> property.
      </p>

      <dl>
        <dt>verificationMethod</dt>
        <dd>
If a <a>DID document</a> includes a <code>verificationMethod</code> property,
the value of the property MUST be an unordered set of verification methods,
where each verification method is described by a set of properties.
The set of properties MUST include the <code>id</code>, <code>type</code>,
<code>controller</code>, and specific verification method properties, and
MAY include additional properties.
        </dd>
      </dl>

      <p>
The value of the <code>id</code> property for a verification method MUST be a
<a>URI</a>. When more than one verification method is present, the value of
<code>verificationMethod</code> MUST NOT contain multiple entries with the same
<code>id</code>. If the value of <code>verificationMethod</code> contains
multiple entries with the same <code>id</code>, a <a>DID document</a> processor
MUST produce an error.
      </p>

      <p>
The value of the <code>type</code> property MUST be exactly one verification
method type. In order to maximize global interoperability, the
<a>verification method</a> type SHOULD be registered in the
[[DID-SPEC-REGISTRIES]].
      </p>

      <p>
The value of the <code>controller</code> property, MUST be a valid <a>DID</a>.
      </p>

      <p>
In order to maximize global interoperability, the verification method
SHOULD be registered in the [[DID-SPEC-REGISTRIES]].
      </p>

      <pre class="example" title="Example verification methods">
{
  "@context": ["https://www.w3.org/ns/did/v1", "https://w3id.org/security/v1"],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "verificationMethod": [{
    "id": <span class="comment">...</span>,
    "type": <span class="comment">...</span>,
    "controller": <span class="comment">...</span>,
    <span class="comment">...</span>
  ]}
}
      </pre>

    <section>
      <h2>Public Keys</h2>

      <p>
A public key is a <a>verification method</a>.
Public keys are used for digital signatures, encryption and other cryptographic
operations, which in turn are the basis for purposes such as authentication
(see Section <a href="#authentication"></a>) or establishing secure
communication with <a>service endpoints</a> (see Section
<a href="#service-endpoints"></a>). As well, public keys can play a role in
authorization mechanisms of <a>DID</a> method operations (see Section
<a href="#method-operations"></a>), which can be defined by <a>DID method</a>
specifications.
      </p>

      <p>
Public keys can be included in a <a>DID document</a> using the
<code>publicKey</code> or <code>authentication</code> properties, depending on
what they are to be used for. Each public key has properties for an identifier
(<code>id</code>) of its own, a <code>type</code>, and a <code>controller</code>,
as well as other properties that depend on the type of key it is.
      </p>

      <p>
This specification strives to limit the number of formats for expressing public
key material in a DID Document to the fewest possible, to increase the
likelihood of interoperability. The fewer formats that implementers have to
implement, the more likely it will be that they will support all of them. This
approach attempts to strike a delicate balance between ease of implementation
and supporting formats that have historically had broad deployment. The specific
types of key formats that are supported in this specification are listed below.
      </p>

      <p>
A <a>DID document</a> MAY include a <code>publicKey</code> property.
      </p>

      <dl>
        <dt>publicKey</dt>
        <dd>
If a <a>DID document</a> includes a <code>publicKey</code> property, the value
of the property MUST be an unordered set of public keys, where each public
key is described by a set of properties. Each public key MUST have the <code>id</code>,
<code>type</code>, <code>controller</code>, and specific public key properties,
and MAY include additional properties.
        </dd>
      </dl>

      <p>
The value of the <code>id</code> property MUST be a <a>URI</a>. The value of
<code>publicKey</code> MUST NOT contain multiple entries with the same
<code>id</code>. In this case, a <a>DID document</a> processor MUST produce an
error.
      </p>

      <p>
The value of the <code>type</code> property MUST be exactly one public key type.
For a registry of available key types and formats, see [[DID-SPEC-REGISTRIES]].
      </p>

      <p>
The value of the <code>controller</code> property, which identifies the
controller of the corresponding private key, MUST be a valid <a>DID</a>.
      </p>

      <p class="note" title="Key controller(s) and DID controller(s)">
The semantics of the <code>controller</code> property are the same when the
subject of the relationship is the <a>DID document</a> as when the subject
of the relationship is a key. Since a key can't control itself, and the
key controller cannot be inferred from the <a>DID document</a>, it is
necessary to explicitly express the identity of the controller of the key
(which may be the <a>DID controller</a> or <a>DID subject</a>). The
difference is that the value of <code>controller</code> on a key is not
necessarily a <a>DID controller</a>. <a>DID controller(s)</a> are
expressed using the <code>controller</code> property on the top level of
the <a>DID document</a>; see Section
<a href="#authorization-and-delegation"></a>.
      </p>

      <p>
The value of the <code>id</code> property MAY be structured as a
<a href="https://en.wikipedia.org/wiki/Compound_key">compound key</a>. This is
especially useful for integrating with existing key management systems and key
formats such as <a href="https://tools.ietf.org/html/rfc7517">JWK</a>. It is
RECOMMENDED that <a href="https://tools.ietf.org/html/rfc7517">JWK</a>
<code>kid</code> values are set to the
<a href="https://tools.ietf.org/html/rfc7638">public key fingerprint</a>. It is
RECOMMENDED that verification methods that use JWKs to represent their public
keys utilize the value of <code>kid</code> as their fragment identifier. See the
first key in <a href="#example-15-various-public-keys">EXAMPLE 15</a> for an
example of a public key with a compound key identifier.
      </p>

      <p>
All public key property names MUST be registered in the [[DID-SPEC-REGISTRIES]].
      </p>

      <p>
If a public key does not exist in the <a>DID document</a>, it MUST be assumed
the key was revoked or is invalid.
The <a>DID document</a> MUST NOT express revoked keys using a
<a>verification relationship</a>.
Each
<a>DID method</a> specification is expected to detail how revocation is
performed and tracked.
      </p>

      <p>
Public keys of all types MUST be expressed in either JSON Web Key (JWK) format
using the <code>publicKeyJwk</code> property or one of the formats listed in the
table below. Public key expression MUST NOT use any other key format.
      </p>

      <p class="issue">
The Working Group is still debating whether the base encoding format used will
be Base58 (Bitcoin) [[BASE58]], base64url [[RFC7515]], or base16 (hex)
[[RFC4648]]. The entries in the table below currently assume PEM and Base58
(Bitcoin), but might change to base64url and/or base16 (hex) after the group
achieves consensus on this particular issue.
      </p>

      <p class="issue">
The Working Group is still debating whether secp256k1 Schnorr public key values
will be elaborated upon in this specification and if so, how they will be
expressed and encoded.
      </p>

      <table class="simple">
        <thead>
          <tr>
            <th>
Key&nbsp;Type
            </th>
            <th>
Support
            </th>
          </tr>
        </thead>

        <tbody>
          <tr>
            <td>
RSA
            </td>
            <td>
RSA public key values MUST either be encoded as a JWK or be encoded in
Privacy Enhanced Mail (PEM) format using the <code>publicKeyPem</code> property.
            </td>
          </tr>
          <tr>
            <td>
ed25519
            </td>
            <td>
Ed25519 public key values MUST either be encoded as a JWK or be encoded as
the raw 32-byte public key value in Base58 Bitcoin format using the
<code>publicKeyBase58</code> property.
            </td>
          </tr>
          <tr>
            <td>
secp256k1-koblitz
            </td>
            <td>
Secp256k1 Koblitz public key values MUST either be encoded as a JWK or be
encoded as the raw 33-byte public key value in Base58 Bitcoin format using the
<code>publicKeyBase58</code> property.
            </td>
          </tr>
          <tr>
            <td>
secp256r1
            </td>
            <td>
Secp256r1 public key values MUST either be encoded as a JWK or be encoded as
the raw 32-byte public key value encoded in Base58 Bitcoin format using the
<code>publicKeyBase58</code> property.
            </td>
          </tr>
          <tr>
            <td>
Curve25519
            </td>
            <td>
Curve25519 (also known as X25519) public key values MUST either be encoded as
a JWK or be encoded as the raw 32-byte public key value in Base58 Bitcoin format
using the <code>publicKeyBase58</code> property.
            </td>
          </tr>
        </tbody>
      </table>

      <p>
Example:
      </p>

      <pre class="example nohighlight" title="Various public keys">
{
  "@context": ["https://www.w3.org/ns/did/v1", "https://w3id.org/security/v1"],
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "publicKey": [{
    "id": "did:example:123#_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A",
    "type": "JwsVerificationKey2020",
    "controller": "did:example:123",
    "publicKeyJwk": {
      "crv": "Ed25519",
      "x": "VCpo2LMLhn6iWku8MKvSLg2ZAoC-nlOyPVQaO3FxVeQ",
      "kty": "OKP",
      "kid": "_Qq0UL2Fq651Q0Fjd6TvnYE-faHiOpRlPVQcY_-tA4A"
    }
  }, {
    "id": "did:example:123456789abcdefghi#keys-1",
    "type": "Ed25519VerificationKey2018",
    "controller": "did:example:pqrstuvwxyz0987654321",
    "publicKeyBase58": "H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV"
  }, {
    "id": "did:example:123456789abcdefghi#keys-2",
    "type": "Secp256k1VerificationKey2018",
    "controller": "did:example:123456789abcdefghi",
    "publicKeyHex": "02b97c30de767f084ce3080168ee293053ba33b235d7116a3263d29f1450936b71"
  }],
  <span class="comment">...</span>
}
      </pre>

      <p>
A key MAY be <em>embedded</em> or <em>referenced</em> in a <a>DID document</a>.
For example, the <code>authentication</code> property might refer to keys in
both ways, as shown in the example below.
      </p>

      <pre class="example nohighlight" title="Various public keys">
{
<span class="comment">...</span>

  "authentication": [
    <span class="comment">// this key is referenced, it may be used with more than one verification relationship</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this key is embedded and may *only* be used for authentication</span>
    {
      "id": "did:example:123456789abcdefghi#keys-2",
      "type": "Ed25519VerificationKey2018",
      "controller": "did:example:123456789abcdefghi",
      "publicKeyBase58": "H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV"
    }
  ],

<span class="comment">...</span>
}
      </pre>

      <p>
The steps to use when processing a <code>publicKey</code> property in a
<a>DID document</a> are:
      </p>

      <ol class="algorithm">
        <li>
Let <em>value</em> be the data associated with the <code>publicKey</code>
property and initialize <em>result</em> to <code>null</code>.
        </li>

        <li>
If <em>value</em> is an object, the key material is embedded. Set
<em>result</em> to <em>value</em>.
        </li>

        <li>
If <em>value</em> is a string, the key is included by reference. Assume
<em>value</em> is a URL.
          <ol>
            <li>
Dereference the URL and retrieve the <code>publicKey</code> properties
associated with the URL. For example, process the <code>publicKey</code>
property at the top-level of the dereferenced document.
            </li>

            <li>
Iterating through each public key object, if the <code>id</code> property of the
object matches <em>value</em>, set <em>result</em> to the object.
            </li>
          </ol>
        </li>

        <li>
If <em>result</em> does not contain at least the <code>id</code>,
<code>type</code>, and <code>controller</code> properties, as well as any
mandatory public cryptographic material, as determined by the <code>type</code>
property of <em>result</em>, throw an error.
        </li>
      </ol>

      <p class="note">
Caching and expiration of the keys in a <a>DID document</a> is entirely the
responsibility of <a>DID resolvers</a> and other clients. For more information,
see Section <a href="#resolution"></a>.
      </p>

    </section>

    <section>
      <h2>
Authorization and Delegation
      </h2>

      <p>
Authorization is the mechanism used to state how operations are performed
on behalf of the <a>DID subject</a>. Delegation is the mechanism that the
subject uses to authorize others to act on their behalf.
      </p>

      <p class="note" title="Authorization vs authentication">
Note that Authorization is separate from <a href="#authentication"></a>.
This is particularly important for key recovery in the case of key loss,
when the subject no longer has access to their keys, or key compromise,
where the <a>DID controller</a>'s trusted third parties need to override
malicious activity by an attacker. See Section
<a href="#security-considerations"></a>.
      </p>

      <p>
A DID document MAY include a <code>controller</code> property to indicate
the <a>DID controller(s)</a>. If so:
      </p>
      <dl>
          <dt>controller</dt>
          <dd>
The value of the <code>controller</code> property MUST be one or more valid
<a>DIDs</a>. The corresponding <a>DID document</a>(s) SHOULD contain
<a>verification relationships</a> that explicitly permit the use of certain
verification methods for specific purposes.
          </dd>
      </dl>

      <p class="note" title="Determining the DID controller">
If the <code>controller</code> property is not present, the
<a>DID controller</a> can be determined by consulting the respective
<a>DID method</a> specification. It cannot be assumed that the
<a>DID subject</a> is also the controller of its own <a>DID</a>, nor
can it be assumed that <em>only</em> entities identified by <a>DIDs</a>
present in the value of <code>controller</code> are capable of exerting
control over the <a>DID</a> in question. Similarly, <a>DID methods</a> are not
obliged to respect the value of <code>controller</code> and can specify means
for updating the <a>DID document</a> that are unrelated to the
<code>controller</code> property.
      </p>

      <p>
Each <a>DID method</a> MUST define how authorization and delegation are
implemented, including any necessary cryptographic operations.
      </p>

      <p>
There are at least two suggested methods for implementing Authorization and
Delegation, which may be layered:
      </p>

      <ul>
        <li>
A <a>verifiable data registry</a> could implement a coarse-grained
<code>controller</code> pattern by enabling <a>DID documents</a> to express
the <a>DID</a> of another <a>DID controller</a> that controls it, or
additionally,
        </li>

        <li>
A <a>verifiable data registry</a> could implement a capabilities-based
approach enabling further fine-grained control of authorization and
delegation.
        </li>
      </ul>

      <pre class="example nohighlight"
        title="DID document with a controller property">
{
  "@context": "https://www.w3.org/ns/did/v1",
  "id": "did:example:123456789abcdefghi",
  "controller": "did:example:bcehfew7h32f32h7af3",
  "service": [{
    <span class="comment">// used to retrieve Verifiable Credentials
    associated with the DID</span>
    "type": "VerifiableCredentialService",
    "serviceEndpoint": "https://example.com/vc/"
  }]
}
      </pre>
    </section>

    <section>
      <h2>Verification Relationships</h2>

      <p>
A <a>verification relationship</a> expresses the relationship between the
<a>DID subject</a> and a <a>verification method</a>.
      </p>
      <p>
A <a>DID document</a> MAY include a property expressing a specific
<a>verification relationship</a>. In order to maximize global
interoperability, the property SHOULD be registered in
[[DID-SPEC-REGISTRIES]].
      </p>
      <p>
A <a>DID controller</a> MUST be explicit about the <a>verification
relationship</a> between the <a>DID subject</a> and the
<a>verification method</a>.
<a>Verification methods</a> that are not associated with a particular
<a>verification relationship</a> MUST NOT be used for that <a>verification
relationship</a>. See the sections below for more detailed examples of a
<a>verification relationship</a>.
      </p>

      <section>
        <h3>authentication</h3>

        <p>
Authentication is a <a>verification relationship</a> which an entity can use
to prove it is the <a>DID subject</a> or acting on behalf of the
<a>DID Subject</a> as a <a>DID Controller</a>. The <em>verifier</em> of an
authentication attempt can check if the authenticating party is presenting a
valid proof of authentication, that is, that they are who they say they are.
Note that a successful authentication on its own might or might not confer
authority; that is up to the verifying application.
        </p>

        <p class="note" title="Uses of authentication">
If authentication is established, it is up to the <a>DID method</a> or other
application to decide what to do with that information. A particular <a>DID
method</a> could decide that authenticating as a <a>DID controller</a> is
sufficient to, for example, update or delete the <a>DID document</a>. Another
<a>DID method</a> could require different keys, or a different verification
method entirely, to be presented in order to update or delete the <a>DID
document</a> than that used to authenticate. In other words, what is done
<em>after</em> the authentication check is out of scope for the DID data
model, but <a>DID methods</a> and applications are expected to define this
themselves.
        </p>

        <p>
A <a>DID document</a> MAY include an <code>authentication</code> property.
The <code>authentication</code> property is an example of a <a>verification
relationship</a>.
        </p>

      <dl>
          <dt>authentication</dt>
          <dd>
The <code>authentication</code> property is a relationship between the <a>DID
subject</a> and a set of verification methods (such as, but not limited to,
public keys). It means that the <a>DID subject</a> has authorized some set of
<a>verification methods</a> (per the value of the <code>authentication</code>
property) for the purpose of authentication. The value of the
<code>authentication</code> property SHOULD be an unordered set of
<a>verification methods</a>. Each <a>verification method</a> MAY be embedded
or referenced. An example of a <a>verification method</a> is a public key
(see Section <a href="#public-keys"></a>).
          </dd>
        </dl>

        <p>
This statement is useful to any <em>authentication verifier</em> that needs
to check to see if an entity that is attempting to authenticate is, in fact,
presenting a valid proof of authentication. When a <em>verifier</em> receives
some data (in some protocol-specific format) that contains a proof that was
made for the purpose of "authentication", and that says that an entity is
identified by the <a>DID</a>, then that <em>verifier</em> checks to ensure
that the proof can be verified using a <a>verification method</a> (e.g.,
public key) listed under <code>authentication</code> in the
<a>DID Document</a>.
        </p>

        <p>
The <a>verification method</a> indicated by the <code>authentication</code>
property of a <a>DID document</a> can only be used to authenticate the
<a>DID subject</a>. To authenticate the <a>DID controller</a> (in cases
where the <a>DID controller</a> is not <em>also</em> the <a>DID subject</a>)
the entity associated with the value of <code>controller</code> (see
Section <a href="#authorization-and-delegation"></a>) needs to
authenticate itself with its <em>own</em> <a>DID document</a> and attached
<code>authentication</code> <a>verification relationship</a>.
        </p>

        <p>
Example:
        </p>

        <pre class="example nohighlight" title="Authentication property
                    containing three verification methods">
{
  "@context": "https://www.w3.org/ns/did/v1",
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "authentication": [
    <span class="comment">// this method can be used to authenticate as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method can be used to authenticate as did:...fghi</span>
    "did:example:123456789abcdefghi#biometric-1",
    <span class="comment">// this method is *only* authorized for authentication, it may not</span>
    <span class="comment">// be used for any other proof purpose, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
      "id": "did:example:123456789abcdefghi#keys-2",
      "type": "Ed25519VerificationKey2018",
      "controller": "did:example:123456789abcdefghi",
      "publicKeyBase58": "H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV"
    }
  ],
  <span class="comment">...</span>
}
        </pre>
      </section>

      <section>
        <h3>assertionMethod</h3>
        <p>
The <code>assertionMethod</code> property is used to express a <a>verification
relationship</a> which indicates that a <a>verification method</a> can be
used to assert a statement on behalf of the <a>DID subject</a>. The
<em>verifier</em> of an <code>assertionMethod</code> attempt can check proof
of a statement asserted on behalf of the <a>DID subject</a> by checking if
the <a>verification method</a> used with the proof is contained in the
<code>assertionMethod</code> of the <a>DID Document</a>.
        </p>

        <p class="note" title="Uses of assertionMethod">
If <code>assertionMethod</code> is established, it is up to the
verifier to validate that the <a>verification method</a> used for
providing proof of an assertion is valid and is associated with the
<code>assertionMethod</code> <a>verification relationship</a>. An example of
when this property is useful is during the processing of a verifiable
credential by a verifier. During validation, a verifier
checks to see if a verifiable credential has been signed by the <a>DID
Subject</a> by checking that the <a>verification method</a> used to
assert the proof is associated with the <code>assertionMethod</code> property
in the corresponding <a>DID Document</a>.
        </p>
        <p>
A <a>DID document</a> MAY include an <code>assertionMethod</code> property.
The <code>assertionMethod</code> property is an example of a <a>verification
relationship</a>.
        </p>

        <p>
Example:
        </p>

        <pre class="example nohighlight" title="Assertion method property
                    containing two verification methods">
{
  "@context": "https://www.w3.org/ns/did/v1",
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "assertionMethod": [
    <span class="comment">// this method can be used to assert statements as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* authorized for assertion of statements, it may not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
      "id": "did:example:123456789abcdefghi#keys-2",
      "type": "Ed25519VerificationKey2018",
      "controller": "did:example:123456789abcdefghi",
      "publicKeyBase58": "H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV"
    }
  ],
  <span class="comment">...</span>
}
        </pre>
        </section>

        <section>
          <h3>keyAgreement</h3>
          <p>
The <code>keyAgreement</code> property is used to express a
<a>verification relationship</a> which an entity can use to engage in key
agreement protocols on behalf of the <a>DID subject</a>. The
<em>counterparties</em> in a key agreement protocol can use the
<code>keyAgreement</code> <a>verification relationship</a> to check whether a
party performing a key agreement protocol on behalf of the <a>DID subject</a>
is authorized by checking if the <a>verification method</a> used during the
key agreement protocol is associated with the <code>keyAgreement</code>
property contained in the <a>DID Document</a>.
        </p>

        <p class="note" title="Uses of keyAgreement">
It is up to a verifier to validate that the <a>verification method</a>
used during a key agreement exchange is valid and is associated with the
<code>keyAgreement</code> property. An example of when this property is useful
is during the establishment of a TLS session on behalf of the <a>DID
Subject</a>. In this case, the counterparty checks that the <a>verification
method</a> used during the protocol handshake is associated with the
<code>keyAgreement</code> property in the <a>DID Document</a>.
        </p>

        <p>
A <a>DID document</a> MAY include an <code>keyAgreement</code> property.
The <code>keyAgreement</code> property is an additional example of a
<a>verification relationship</a>.
        </p>

        <p>
Example:
        </p>

        <pre class="example nohighlight" title="Key agreement property
                    containing two verification methods">
{
  "@context": "https://www.w3.org/ns/did/v1",
  "id": "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "keyAgreement": [
    <span class="comment">// this method can be used to perform key agreement as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* authorized for key agreement usage, it may not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
      "id": "did:example:123#zC9ByQ8aJs8vrNXyDhPHHNNMSHPcaSgNpjjsBYpMMjsTdS",
      "type": "X25519KeyAgreementKey2019",
      "controller": "did:example:123",
      "publicKeyBase58": "9hFgmPVfmBZwRvFEyniQDBkz9LmV7gDEqytWyGZLmDXE"
    }
  ],
  <span class="comment">...</span>
}

        </pre>
      </section>

      <section>
        <h3>capabilityInvocation</h3>
        <p>
The <code>capabilityInvocation</code> property is used to express a
<a>verification relationship</a> which an entity can use to invoke
capabilities as the <a>DID subject</a> or on behalf of the <a>DID subject</a>.
A capability is an expression of an action that the <a>DID subject</a> is
authorized to take. The <em>verifier</em> of a capability invocation attempt
can check the validity of a capability by checking if the
<a>verification method</a> used with the proof is contained in the
<code>capabilityInvocation</code> property of the <a>DID Document</a>.
        </p>

        <p class="note" title="Uses of capabilityInvocation">
It is the responsibility of a verifier to ensure that the
<a>verification method</a> used when presenting a capability is invoked and is
associated with the <code>capabilityInvocation</code> property. An example of
when this property is useful is when a <a>DID subject</a> chooses to invoke
their capability to start a vehicle through the combined usage of a
<a>verification method</a> and the <code>StartCar</code> capability. In this
example, the vehicle would be the <em>verifier</em> and would need to verify
that the <a>verification method</a> exists in the
<code>capabilityInvocation</code> property.
        </p>

        <p>
A <a>DID document</a> MAY include an <code>capabilityInvocation</code>
property. The <code>capabilityInvocation</code> property is an additional
example of a <a>verification relationship</a>.
        </p>

        <p>
Example:
        </p>

        <pre class="example nohighlight" title="Capability invocation property
                    containing two verification methods">
{
  "@context": "https://www.w3.org/ns/did/v1", "id":
  "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "capabilityInvocation: [
    <span class="comment">// this method can be used to invoke capabilities as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* authorized for capability invocation usage, it may not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
    "id": "did:example:123456789abcdefghi#keys-2",
    "type": "Ed25519VerificationKey2018",
    "controller": "did:example:123456789abcdefghi",
    "publicKeyBase58": "H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV"
    }
  ],
  <span class="comment">...</span>
}

        </pre>
      </section>

      <section>
        <h3>capabilityDelegation</h3>
        <p>
The <code>capabilityDelegation</code> property is used to express a
<a>verification relationship</a> which an entity can use to grant capabilities
as the <a>DID subject</a> or on behalf of the <a>DID subject</a> to other
<em>capability invokers</em>. The <em>verifier</em> of a
<code>capabilityDelegation</code> attempt can check the validity of a
capability to grant invocation of a capability by checking if the
<a>verification method</a> used with the proof is contained in the
<code>capabilityDelegation</code> section of the <a>DID Document</a>.
        </p>

        <p class="note" title="Uses of capabilityDelegation">
It is up to a verifier to validate that the <a>verification method</a>
used when presenting a capability is valid and is associated with the
<code>capabilityDelegation</code> property. An example of when this property
is useful is when a <a>DID Subject</a> chooses to grant their capability to
start a vehicle through the combined usage of a <a>verification method</a> and
the <code>StartCar</code> capability to a capability invoker.
        </p>

        <p>
A <a>DID document</a> MAY include an <code>capabilityDelegation</code>
property. The <code>capabilityDelegation</code> property is an additional
example of a <a>verification relationship</a>.
        </p>

        <p>
Example:
        </p>

        <pre class="example nohighlight" title="Capability Delegation property
                    containing two verification methods">
{
  "@context": "https://www.w3.org/ns/did/v1", "id":
  "did:example:123456789abcdefghi",
  <span class="comment">...</span>
  "capabilityDelegation": [
    <span class="comment">// this method can be used to perform capabilty delegation as did:...fghi</span>
    "did:example:123456789abcdefghi#keys-1",
    <span class="comment">// this method is *only* authorized for granting capabilities it may not</span>
    <span class="comment">// be used for any other verification relationship, so its full description is</span>
    <span class="comment">// embedded here rather than using only a reference</span>
    {
    "id": "did:example:123456789abcdefghi#keys-2",
    "type": "Ed25519VerificationKey2018",
    "controller": "did:example:123456789abcdefghi",
    "publicKeyBase58": "H3C2AVvLMv6gmMNam3uVAjZpfkcJCwDwnZn6z3wXmqPV"
    }
  ],
  <span class="comment">...</span>
}

        </pre>
      </section>
    </section>
  </section>

    <section>
      <h2>Service Endpoints</h2>

      <p>
<a>Service endpoints</a> are used in <a>DID documents</a> to express ways of
communicating with the <a>DID subject</a> or associated entities. Services
listed in the <a>DID document</a> can contain information about privacy
preserving messaging services, or more public information, such as social media
accounts, personal websites, and email addresses although this is discouraged.
See <a href="#keep-personally-identifiable-information-pii-private"></a> for
additional details. The metadata associated with services are often
service-specific. For example, the metadata associated with an encrypted
messaging service can express how to initiate the encrypted link before
messaging begins.
      </p>
      <p>
Pointers to services are expressed using the <code>service</code> property.
Each service has its own <code>id</code> and <code>type</code> properties, as
well as a <code>serviceEndpoint</code> property with a <a>URI</a> or a set of
other properties describing the service.
      </p>

      <p>
One of the primary purposes of a <a>DID document</a> is to enable discovery of
<a>service endpoints</a>. A <a>service endpoint</a> can be any type of service
the <a>DID subject</a> wants to advertise, including
<a>decentralized identity management</a> services for further discovery,
authentication, authorization, or interaction.
      </p>

      <p>
A <a>DID document</a> MAY include a <code>service</code> property.
      </p>

      <dl>
        <dt>service</dt>
        <dd>
If a <a>DID document</a> includes a <code>service</code> property, the value of
the property SHOULD be an unordered set of <a>service endpoint</a>s, where
each service endpoint is described by a set of properties. Each <a>service endpoint</a>
MUST have <code>id</code>, <code>type</code>, and <code>serviceEndpoint</code>
properties, and MAY include additional properties.
        </dd>
      </dl>

      <p>
The value of the <code>id</code> property MUST be a <a>URI</a>.
The value of <code>serviceEndpoint</code> MUST NOT contain multiple entries
with the same <code>id</code>. In this case, a <a>DID document</a> processor
MUST produce an error.
      </p>

      <p>
The value of the <code>serviceEndpoint</code> property MUST be a valid
<a>URI</a> conforming to [[RFC3986]] and normalized according to the
rules in section 6 of [[RFC3986]] and to any normalization rules in its
applicable <a>URI</a> scheme specification, <em>OR</em> a set of properties
which describe the service endpoint further.
      </p>

      <p>
It is expected that the <a>service endpoint</a> protocol is published in an open
standard specification.
      </p>

      <pre class="example nohighlight" title="Various service endpoints">
{
  "service": [{
    "id": "did:example:123456789abcdefghi#openid",
    "type": "OpenIdConnectVersion1.0Service",
    "serviceEndpoint": "https://openid.example.com/"
  }, {
    "id": "did:example:123456789abcdefghi#vcr",
    "type": "CredentialRepositoryService",
    "serviceEndpoint": "https://repository.example.com/service/8377464"
  }, {
    "id": "did:example:123456789abcdefghi#xdi",
    "type": "XdiService",
    "serviceEndpoint": "https://xdi.example.com/8377464"
  }, {
    "id": "did:example:123456789abcdefghi#agent",
    "type": "AgentService",
    "serviceEndpoint": "https://agent.example.com/8377464"
  }, {
    "id": "did:example:123456789abcdefghi#hub",
    "type": "IdentityHub",
    "publicKey": "did:example:123456789abcdefghi#key-1",
    "serviceEndpoint": {
      "@context": "https://schema.identity.foundation/hub",
      "type": "UserHubEndpoint",
      "instances": ["did:example:456", "did:example:789"]
    }
  }, {
    "id": "did:example:123456789abcdefghi#messages",
    "type": "MessagingService",
    "serviceEndpoint": "https://example.com/messages/8377464"
  }, {
    "id": "did:example:123456789abcdefghi#inbox",
    "type": "SocialWebInboxService",
    "serviceEndpoint": "https://social.example.com/83hfh37dj",
    "description": "My public social inbox",
    "spamCost": {
      "amount": "0.50",
      "currency": "USD"
    }
  }, {
    "id": "did:example:123456789abcdefghi#authpush",
    "type": "DidAuthPushModeVersion1",
    "serviceEndpoint": "http://auth.example.com/did:example:123456789abcdefg"
  }]
}
      </pre>

      <p>
For more information about security considerations regarding authentication
<a>service endpoints</a> see Sections <a href="#method-schemes"></a>
and <a href="#authentication"></a>.
      </p>
    </section>

    <section class="normative">
      <h2>Created</h2>

      <p>
A <a>DID document</a> SHOULD include a <code>created</code> property.
      </p>

      <dl>
          <dt>created</dt>
          <dd>
If a <a>DID document</a> includes a <code>created</code> property, the value of
the property MUST be a valid XML datetime value, as defined in section 3.3.7 of
<a href="https://www.w3.org/TR/xmlschema11-2/">W3C XML Schema Definition
Language (XSD) 1.1 Part 2: Datatypes</a> [[XMLSCHEMA11-2]]. This datetime value
MUST be normalized to UTC 00:00, as indicated by the trailing "Z".
          </dd>
      </dl>

      <pre class="example nohighlight">
{
  "created": "2002-10-10T17:00:00Z"
}
      </pre>
    </section>

    <section>
      <h2>Updated</h2>

      <p>
Standard metadata for identifier records includes a timestamp of the most recent
change.
      </p>

      <p>
A <a>DID document</a> SHOULD include an <code>updated</code> property.
      </p>

      <dl>
          <dt>updated</dt>
          <dd>
If a <a>DID document</a> includes an <code>updated</code> property, the value of
the property MUST follow the same formatting rules as the <code>created</code>
property, as outlined in Section <a href="#created"></a>.
          </dd>
      </dl>

      <pre class="example nohighlight">
{
  "updated": "2016-10-17T02:41:00Z"
}
      </pre>
    </section>

  </section>

  <section class="normative">
    <h1>Core Representations</h1>

    <p>
All concrete representations of a <a>DID document</a> MUST be serialized using a
deterministic mapping that is able to be unambiguously parsed into the data
model defined in this specification. All serialization methods MUST define rules
for the bidirectional translation of a <a>DID document</a> both into and out of
the representation in question. As a consequence, translation between any two
representations MUST be done by parsing the source format into a <a>DID
document</a> model (described in Sections <a href="#data-model"></a> and <a
href="#core-properties"></a>) and then serializing the <a>DID document</a> model
into the target representation. An implementation MUST NOT convert between
representations without first parsing to a <a>DID document</a> model.
    </p>

    <p>
Although syntactic mappings are provided for JSON, JSON-LD, and CBOR here,
applications and services MAY use any other data representation syntax that is
capable of expressing the data model, such as XML or YAML.
    </p>

    <p>
Producers MUST indicate which representation of a document has been used via a
media type in the document's metadata. Consumers MUST determine which
representation a document is in via the <code>content-type</code> DID resolver
metadata field. (See <a href="#did-resolution"></a>). Consumers MUST NOT
determine the representation of a document through its content alone.
    </p>

    <p class="issue" data-number="203">
This requirement depends on the return of DID document metadata that still needs
to be defined by this specification. Once defined, that should be linked from
here.
    </p>

    <p>
The production and consumption rules in this section apply to all
implementations seeking to be fully compatible with independent implementations
of the specification. Deployments of this specification MAY use a custom
agreed-upon representation, including localized rules for handling properties
not listed in the registry. See section <a href="#extensibility"></a>
for more information.
    </p>

    <p class="issue" data-number="207">
A link to a section on extensibility and conformance as it applies to data
representations should be added here once that section has been written.
    </p>

    <section>
      <h2>
JSON
      </h2>

      <p>
When producing and consuming DID documents that are in plain JSON (as indicated
by a <code>content-type</code> of <code>application/did+json</code> in the
resolver metadata), the following rules MUST be followed.
      </p>

      <section>
        <h3>Production</h3>

        <p>
A <a>DID document</a> MUST be a single <a data-cite="RFC8259#section-4">JSON
object</a> conforming to [[!RFC8259]]. All top-level properties of the <a>DID
document</a> MUST be represented by using the property name as the name of the
member of the JSON object. The values of properties of the data model described
in Section <a href="#data-model"></a>, including all extensions, MUST be encoded
in JSON [[RFC8259]] by mapping property values to JSON types as follows:
        </p>

        <ul>
          <li>
Numeric values representable as IEEE754 MUST be represented as a
<a data-cite="RFC8259#section-6">Number type</a>.
          </li>
          <li>
Boolean values MUST be represented as a <a data-cite="RFC8259#section-3">Boolean
literal</a>.
          </li>
          <li>
Sequence value MUST be represented as an <a data-cite="RFC8259#section-5">Array
type</a>.
          </li>
          <li>
Unordered sets of values MUST be represented as an <a
data-cite="RFC8259#section-5">Array type</a>.
          </li>
          <li>
Sets of properties MUST be represented as an <a
data-cite="RFC8259#section-4">Object type</a>.
          </li>
          <li>
Empty values MUST be represented as a <a data-cite="RFC8259#section-3">null
literal</a>.
          </li>
          <li>
Other values MUST be represented as a <a data-cite="RFC8259#section-7">String
type</a>.
          </li>
        </ul>

        <p class="issue" data-number="204">
An "empty" value is not specified by this document. It seems to imply a null
value, but this is unclear.
        </p>

        <p>
All properties of the <a>DID document</a> MUST be included in
the root object. Properties MAY define additional data sub structures subject
to the value representation rules in the list above.
        </p>

        <p>
The member name <code>@context</code> MUST NOT be used as this property is
reserved for JSON-LD producers.
        </p>

      </section>

      <section>
        <h3>
Consumption
        </h3>

        <p class="issue" data-number="204">
In this section and we use the term "property name" to refer to the string that
represents the property itself, but this specification still needs to define a
concrete term for such aspects of a property of a DID document. We also need a
concrete term for "the document itself" as opposed to "the collection or
properties of the document".
        </p>

        <p>
The top-level element MUST be a JSON object. Any other data type at the top
level is an error and MUST be rejected. The top-level JSON object represents
the <a>DID document</a>, and all members of this object are properties of the
<a>DID document</a>. The object member name is the property name, and the
member value is interpreted as follows:
        </p>

        <ul>
          <li>
<a data-cite="RFC8259#section-6">Number types</a> MUST interpreted as numeric
values representable as IEEE754.
          </li>
          <li>
<a data-cite="RFC8259#section-3">Boolean literals</a> MUST be interpreted as a
Boolean value.
          </li>
          <li>
An <a data-cite="RFC8259#section-5">Array type</a> MUST be interpreted as a
Sequence or Unordered set, depending on the definition of the property for this
value.
          </li>
          <li>
An <a data-cite="RFC8259#section-4">Object type</a> MUST be interpreted as a
sets of properties.
          </li>
          <li>
A <a data-cite="RFC8259#section-3">null literal</a> MUST be interpreted as an
Empty value.
          </li>
          <li>
<a data-cite="RFC8259#section-7">String types</a> MUST be interpreted as
Strings, which may be further parsed depending on the definition of the property
for this value into more specific data types such as URIs, date stamps, or other
values.
          </li>
        </ul>

        <p class="issue" data-number="204">
An "empty" value is not specified by this document. It seems to imply a null
value, but this is unclear.
        </p>

        <p>
The value of the <code>@context</code> object member MUST be ignored as this is
reserved for JSON-LD consumers.
        </p>

        <p>
Unknown object member names MUST be ignored as unknown properties.
        </p>

        <p class="issue" data-number="205">
This specification needs to define clear and consistent rules for how to handle
unknown data members on consumption, and this section needs to be updated with
that decision.
        </p>

      </section>

    </section>

    <section>
      <h2>
JSON-LD
      </h2>

      <p>
[[!JSON-LD]] is a JSON-based format used to serialize
<a href="http://www.w3.org/TR/ld-glossary/#linked-data">Linked Data</a>.
      </p>

      <p>
When producing and consuming DID documents that are in JSON-LD (as indicated by
a <code>content-type</code> of <code>application/did+ld+json</code> in the
resolver metadata), the following rules MUST be followed.
      </p>

      <ul>
        <li>
The <code>@id</code> and <code>@type</code> keywords are aliased to
<code>id</code> and <code>type</code> respectively, enabling developers to use
this specification as idiomatic JSON.
        </li>
        <li>
Even though JSON-LD allows any IRI as node identifiers, <a>DID documents</a>
are explicitly restricted to only describe DIDs. This means that the value of
<code>id</code> MUST be a valid <a>DID</a> and not any other kind of IRI.
        </li>
        <li>
Data types, such as integers, dates, units of measure, and URLs, are
automatically typed to provide stronger type guarantees for use cases that
require them.
        </li>
      </ul>

      <section>
        <h3>
Production
        </h3>

        <p>
The <a>DID document</a> is serialized following the rules in the JSON processor,
with one addition: <a>DID documents</a> MUST include the <code>@context</code>
property.
        </p>

        <dl>
          <dt>@context</dt>
          <dd>
The value of the <code>@context</code> property MUST be one or more <a>URIs</a>,
where the value of the first <a>URI</a> is
<code>https://www.w3.org/ns/did/v1</code>. All members of the
<code>@context</code> property MUST exist be in the DID properties extension
registry.
          </dd>
        </dl>

        <p class="issue" data-number="202">
This specification defines globally interoperable documents, and the requirement
that the context value be in the verifiable data registry means that different JSON-LD
processors can consume the document without having to dereference anything in
the context field. However, a pair of producers and consumers can have local
extension agreements. This needs to be clarified in a section on extensibility
and linked here when available.
        </p>

      </section>

      <section>
        <h3>
Consumption
        </h3>

        <p>
The top-level element MUST be a JSON object. Any other data type at the top
level is an error and MUST be rejected. This top-level JSON object is
interpreted using JSON-LD processing under the rules of the defined
<code>@context</code> fields.
        </p>

        <dl>
          <dt>@context</dt>
          <dd>
The value of the <code>@context</code> property MUST be one or more <a>URIs</a>,
where the value of the first <a>URI</a> is
<code>https://www.w3.org/ns/did/v1</code>. If more than one <a>URI</a> is
provided, the <a>URIs</a> MUST be interpreted as an ordered set. It is
RECOMMENDED that dereferencing each <a>URI</a> results in a document containing
machine-readable information about the context.
          </dd>
        </dl>

        <p>
Unknown object member names MUST be ignored as unknown properties.
        </p>

        <p class="issue" data-number="205">
This specification needs to define clear and consistent rules for how to handle
unknown data members on consumption, and this section needs to be updated with
that decision.
        </p>

      </section>

    </section>

    <section>
      <h2>CBOR</h2>
      <p>
Like Javascript Object Notation (JSON) [[RFC8259]], Concise Binary Object
Representation (CBOR) [[RFC7049]] defines a set of formatting rules for the
portable representation of structured data. CBOR is a more concise,
machine-readable, language-independent data interchange format that is
self-describing and has built-in semantics for interoperability.  With specific
constraints, CBOR can support all JSON data types (including JSON-LD) for
translation between the DID document model (described in <a
href="#data-model">Data Model</a> and <a>DID Documents</a>) and other core
representations.
      </p>

      <p>
Concise Data Definition Language (CDDL) [[RFC8610]] is a notation used to
express Concise Binary Object Representation (CBOR), and by extension JSON Data
Structures. The following notation expresses the DID Document model in CBOR
representation with specific constraints for deterministic mappings between
other core representations.
      </p>

      <pre class="example nohighlight" title="DID Document data model for CBOR expressed in CDDL notation">
DID-document = {
  ? @context : uri
  id : did
  ? publicKey : [* publicKey ]
  ? authentication :  [ *did // *publicKey // *tstr ]
  ? service : [ + service  ]
  ? controller : did / [ *did ]
  ? created : time
  ? updated : time
  proof :  any
}

publicKey = {
  id : did
  type : text
  controller : uri
}

did = tstr .pcre "^did\\:(?&lt;method-name>[a-z0-9]{2,})\\:(?&lt;method-specific-id>[A-Za-z0-9\\.\\-\\:\\_]+)"

did-url =  tstr .pcre "^did\\:(?&lt;method-name>[a-z0-9]{2,})\\:(?&lt;method-specific-id>[A-Za-z0-9\\.\\-\\:\\_]+)\\;(?&lt;path>[A-Za-z0-9\\/)(?&lt;query>\\?[a-z0-9\\=\\&amp;])#(?&lt;fragment>.+)"

service = {
  id : did-url
  type : text
  serviceEndpoint : uri
  ? description : text
  * tstr => any
}
      </pre>

      <section>
        <h3>Production</h3>
        <p>
When producing DID Documents that are represented as CBOR, in addition to the
suggestions in section 3.9 of the CBOR [[RFC7049]] specification for
deterministic mappings, the following constraints of the DID Document model
MUST be followed:
        </p>

        <ul>
          <li>
Map keys MUST be strings.
          </li>
          <li>
Integer encoding MUST be as short as possible.
          </li>
          <li>
The expression of lengths in CBOR major types 2 through 5 MUST be as short as
possible.
          </li>
          <li>
All floating point values MUST be encoded as 64-bits, even for integral values.
          </li>
        </ul>

        <pre class="example nohighlight" title="An example DID Document represented as contrained CBOR and exported in diagnostic annotation mode for easy readibility">
    a7                                                # map(7)
    62                                                #   text(2)
       6964                                           #     "id"
    78 40                                             #   text(64)
       6469643a6578616d706c653a31324433               #     "did:example:12D3"
       4b6f6f574d4864727a6377706a626472               #     "KooWMHdrzcwpjbdr"
       5a733547477145524176636771583362               #     "Zs5GGqERAvcgqX3b"
       3564707550745061396f743639796577               #     "5dpuPtPa9ot69yew"
    65                                                #   text(5)
       70726f6f66                                     #     "proof"
    a4                                                #   map(4)
       64                                             #     text(4)
          74797065                                    #       "type"
       74                                             #     text(20)
          656432353531395369676e617475726532303138    #       "ed25519Signature2018"
       67                                             #     text(7)
          63726561746564                              #       "created"
       74                                             #     text(20)
          323032302d30352d30315430333a30303a30325a    #       "2020-05-01T03:00:02Z"
       67                                             #     text(7)
          63726561746f72                              #       "creator"
       78 8c                                          #     text(140)
          6469643a6578616d706c653a31324433            #       "did:example:12D3"
          4b6f6f574d4864727a6377706a626472            #       "KooWMHdrzcwpjbdr"
          5a733547477145524176636771583362            #       "Zs5GGqERAvcgqX3b"
          3564707550745061396f743639796577            #       "5dpuPtPa9ot69yew"
          3b206578616d706c653a6b65793d6964            #       "; example:key=id"
          3d626166797265696375627478357771            #       "=bafyreicubtx5wq"
          6f336e6f73633463617a726b63746668            #       "o3nosc4cazrkctfh"
          776436726577657a6770776f65347377            #       "wd6rewezgpwoe4sw"
          69726c733465626468733269                    #       "irls4ebdhs2i"
       6e                                             #     text(14)
          7369676e617475726556616c7565                #       "signatureValue"
       78 58                                          #     text(88)
          6f3972364c78676f474e38466f616565            #       "o9r6LxgoGN8Foaee"
          554136456444637631324776447a4645            #       "UA6EdDcv12GvDzFE"
          6d43676a577a76707572325953517941            #       "mCgjWzvpur2YSQyA"
          3857327230535357554b2b6e4835744d            #       "8W2r0SSWUK+nH5tM"
          717a61464c756e3677775a31456f7433            #       "qzaFLun6wwZ1Eot3"
          37616d4744673d3d                            #       "7amGDg=="
    67                                                #   text(7)
       63726561746564                                 #     "created"
    74                                                #   text(20)
       323031382d31322d30315430333a30303a30305a       #     "2018-12-01T03:00:00Z"
    67                                                #   text(7)
       75706461746564                                 #     "updated"
    74                                                #   text(20)
       323032302d30352d30315430333a30303a30305a       #     "2020-05-01T03:00:00Z"
    68                                                #   text(8)
       40636f6e74657874                               #     "@context"
    78 1c                                             #   text(28)
       68747470733a2f2f7777772e77332e6f               #     "https://www.w3.o"
       72672f6e732f6469642f7631                       #     "rg/ns/did/v1"
    69                                                #   text(9)
       7075626c69634b6579                             #     "publicKey"
    81                                                #   array(1)
       a5                                             #     map(5)
          62                                          #       text(2)
             6964                                     #         "id"
          78 85                                       #       text(133)
             6261667972656963756274783577716f         #         "bafyreicubtx5wqo"
             336e6f73633463617a726b6374666877         #         "3nosc4cazrkctfhw"
             6436726577657a6770776f6534737769         #         "d6rewezgpwoe4swi"
             726c7334656264687332693b6578616d         #         "rls4ebdhs2i;exam"
             706c653a6b65793d6964626166797265         #         "ple:key=idbafyre"
             6963756274783577716f336e6f736334         #         "icubtx5wqo3nosc4"
             63617a726b6374666877643672657765         #         "cazrkctfhwd6rewe"
             7a6770776f6534737769726c73346562         #         "zgpwoe4swirls4eb"
             6468733269                               #         "dhs2i"
          64                                          #       text(4)
             74797065                                 #         "type"
          6e                                          #       text(14)
             45644473615075626c69634b6579             #         "EdDsaPublicKey"
          65                                          #       text(5)
             6375727665                               #         "curve"
          67                                          #       text(7)
             65643235353139                           #         "ed25519"
          67                                          #       text(7)
             65787069726573                           #         "expires"
          74                                          #       text(20)
             323031392d31322d30315430333a30303a30305a #         "2019-12-01T03:00:00Z"
          6f                                          #       text(15)
             7075626c69634b6579426173653634           #         "publicKeyBase64"
          78 2c                                       #       text(44)
             716d7a3774704c4e4b4b4b646c376344         #         "qmz7tpLNKKKdl7cD"
             375062656a4469425670374f4e706d5a         #         "7PbejDiBVp7ONpmZ"
             62666d633763454b396d673d                 #         "bfmc7cEK9mg="
    6e                                                #   text(14)
       61757468656e7469636174696f6e                   #     "authentication"
    81                                                #   array(1)
       78 83                                          #     text(131)
          6469643a6578616d706c653a31324433            #       "did:example:12D3"
          4b6f6f574d4864727a6377706a626472            #       "KooWMHdrzcwpjbdr"
          5a733547477145524176636771583362            #       "Zs5GGqERAvcgqX3b"
          3564707550745061396f743639796577            #       "5dpuPtPa9ot69yew"
          3b6b65792d69643d6261667972656963            #       ";key-id=bafyreic"
          756274783577716f336e6f7363346361            #       "ubtx5wqo3nosc4ca"
          7a726b63746668776436726577657a67            #       "zrkctfhwd6rewezg"
          70776f6534737769726c733465626468            #       "pwoe4swirls4ebdh"
          733269                                      #       "s2i"
        </pre>

      </section>

      <section>
        <h3>Consumption</h3>
        <p>
When consuming DID Documents that are represented as CBOR, in addition to the
suggestions in section 3.9 of the CBOR [[RFC7049]] specification for
deterministic mappings the following constraints of the DID Document model MUST
be followed:
        </p>
        <ul>
          <li>
The keys in every map must be sorted lowest value to highest. Sorting is
performed on the bytes of the representation of the keys.
          </li>
          <li>
Indefinite-length items must be made into definite-length items.
          </li>
        </ul>
      </section>

      <section>
        <h3>CBOR Extensibility</h3>
        <p>
In CBOR, one point of extensibility is with the use of CBOR tags. [[RFC7049]]
defines a basic set of data types, as well as a tagging mechanism that enables
extending the set of data types supported via the <a
href="https://www.iana.org/assignments/cbor-tags/cbor-tags.xhtml">CBOR Tag
Registry</a>. This allows for tags to enhance the semantic description of the
data that follows.
        </p>

        <section>
          <h4>DagCBOR</h4>
          <p>
DagCBOR is a further restricted subset of CBOR for representing the DID Document
as a Directed Acyclic Graph model using canonical CBOR encoding as noted above
with additional constraits.  DagCBOR requires that there exist a single way of
encoding any given object, and that encoded forms contain no superfluous data
that may be ignored or lost in a round-trip decode/encode. When producing and
consuming DID Documents representing in DagCBOR the following rules MUST be
followed
          </p>

          <ul>
            <li>
Use no CBOR tags other than the CID tag (42)
            </li>
          </ul>

          <pre class="example nohighlight" title="DID Document as DagCBOR same as the previous example, but serialized to JSON for easy readability">
{ "@context": "https://www.w3.org/ns/did/v1",
  "authentication": [
    "did:example:12D3KooWMHdrzcwpjbdrZs5GGqERAvcgqX3b5dpuPtPa9ot69yew;key-id=bafyreicubtx5wqo3nosc4cazrkctfhwd6rewezgpwoe4swirls4ebdhs2i"
  ],
  "created": "2018-12-01T03:00:00Z",
  "id": "did:example:12D3KooWMHdrzcwpjbdrZs5GGqERAvcgqX3b5dpuPtPa9ot69yew",
  "proof": {
    "created": "2020-05-01T03:00:02Z",
    "creator": "did:example:12D3KooWMHdrzcwpjbdrZs5GGqERAvcgqX3b5dpuPtPa9ot69yew; example:key=id=bafyreicubtx5wqo3nosc4cazrkctfhwd6rewezgpwoe4swirls4ebdhs2i",
    "signatureValue": "o9r6LxgoGN8FoaeeUA6EdDcv12GvDzFEmCgjWzvpur2YSQyA8W2r0SSWUK+nH5tMqzaFLun6wwZ1Eot37amGDg==",
    "type": "ed25519Signature2018"
  },
  "publicKey": [
    {
      "curve": "ed25519",
      "expires": "2019-12-01T03:00:00Z",
      "id": "bafyreicubtx5wqo3nosc4cazrkctfhwd6rewezgpwoe4swirls4ebdhs2i;example:key=idbafyreicubtx5wqo3nosc4cazrkctfhwd6rewezgpwoe4swirls4ebdhs2i",
      "publicKeyBase64": "qmz7tpLNKKKdl7cD7PbejDiBVp7ONpmZbfmc7cEK9mg=",
      "type": "EdDsaPublicKey"
    }
  ],
  "updated": "2020-05-01T03:00:00Z"
}
          </pre>
        </section>

        <section>
          <h4>COSE signatures</h4>

          <p>
A DID Document proof may be constructed using CBOR semantic tagging, such as
tag 98 for CBOR Object Signing and Encryption (COSE) [[RFC8152]]
          </p>

          <pre class="example nohighlight" title="An example extensibility of COSE signature of CBOR using tag 98 and 42 expressed in diagnostic annotated form">
  D8 62                                        # tag(98)
  67                                           #   text(7)
     7061796c6f6164                            #     "payload"
  d8 2a                                        #   tag(42)
     58 25                                     #     bytes(37)
        00017112206c8fdc5c3d2302dda95034       #       "\x00\x01q\x12 l\x8f\xdc\\=#\x02\xdd\xa9P4"
        f9de57a8591918ecb7d7789387c547f7       #       "\xf9\xdeW\xa8Y\x19\x18\xec\xb7\xd7x\x93\x87\xc5G\xf7"
        a89d05e72f                             #       "\xa8\x9d\x05\xe7/"
  69                                           #   text(9)
     70726f746563746564                        #     "protected"
  a0                                           #   map(0)
  6a                                           #   text(10)
     7369676e617475726573                      #     "signatures"
  81                                           #   array(1)
     a3                                        #     map(3)
        69                                     #       text(9)
           70726f746563746564                  #         "protected"
        66                                     #       text(6)
           613130313236                        #         "a10126"
        69                                     #       text(9)
           7369676e6174757265                  #         "signature"
        78 80                                  #       text(128)
           65326165616664343064363964313964    #         "e2aeafd40d69d19d"
           66653665353230373763356437666634    #         "fe6e52077c5d7ff4"
           65343038323832636265666235643036    #         "e408282cbefb5d06"
           63626634313461663265313964393832    #         "cbf414af2e19d982"
           61633435616339386238353434633930    #         "ac45ac98b8544c90"
           38623435303764653165393062373137    #         "8b4507de1e90b717"
           63336433343831366665393236613262    #         "c3d34816fe926a2b"
           39386635336166643266613066333061    #         "98f53afd2fa0f30a"
        6b                                     #       text(11)
           756e70726f746563746564              #         "unprotected"
        a1                                     #       map(1)
           63                                  #         text(3)
              6b6964                           #           "kid"
           78 85                               #         text(133)
              6469643a697069643a313244334b6f6f #           "did:ipid:12D3Koo"
              574d4864727a6377706a6264725a7335 #           "WMHdrzcwpjbdrZs5"
              47477145524176636771583362356470 #           "GGqERAvcgqX3b5dp"
              7550745061396f7436397965773b6970 #           "uPtPa9ot69yew;ip"
              69643a6b65792d69643d626166797265 #           "id:key-id=bafyre"
              6963756274783577716f336e6f736334 #           "icubtx5wqo3nosc4"
              63617a726b6374666877643672657765 #           "cazrkctfhwd6rewe"
              7a6770776f6534737769726c73346562 #           "zgpwoe4swirls4eb"
              6468733269                       #           "dhs2i"
  6b                                           #   text(11)
     756e70726f746563746564                    #     "unprotected"
  a0                                           #   tag(0)
          </pre>
        </section>
      </section>
    </section>
  </section>

  <section>
    <h1>
Methods
    </h1>

    <p>
<a>DID methods</a> provide the means to implement this specification on
different <a>verifiable data registries</a>. New <a>DID methods</a> are
defined in their own specifications, so that interoperability between
different implementations of the same <a>DID method</a> is ensured. This
section specifies the requirements on any <a>DID method</a>, which are met by
the <a>DID method</a>'s associated specification.
    </p>

    <p>
For adding properties to a <a>DID document</a> which are specific to a
particular <a>DID method</a>, see <a href="#extensibility"></a>.
    </p>

    <section class="normative">
      <h2>Method Schemes</h2>

      <p>
A <a>DID method</a> specification MUST define exactly one method-specific
<a>DID scheme</a>, identified by exactly one method name (see the
<code>method-name</code> rule in Section <a href="#did-syntax"></a>).
      </p>

      <p>
The authors of a new <a>DID method</a> specification SHOULD use a method name
that is unique among all <a>DID method</a> names known to them at the time of
publication.
      </p>

      <p>
The method name SHOULD be five characters or less.
      </p>

      <div class="note" title="Unique DID method names">
        <p>
Because there is no central authority for allocating or approving <a>DID
method</a> names, there is no way to know for certain if a specific <a>DID
method</a> name is unique. To help with this challenge, a non-authoritative
list of known <a>DID method</a> names and their associated specifications is
maintained in the DID Methods Registry, which is part of [[?DID-SPEC-REGISTRIES]].
        </p>
        <p>
  Authors of new <a>DID method</a> specifications are encouraged to add their
  method names to the DID Method Registry so that other implementors
  and members of the community have a place to see an overview of existing
  <a>DID methods</a>.
        </p>
      </div>

      <p>
The <a>DID method</a> specification MUST specify how to generate the
<code>method-specific-id</code> component of a <a>DID</a>.
      </p>
      <p>
The <code>method-specific-id</code> value MUST be able to be generated without
the use of a centralized registry service.
      </p>
      <p>
The <code>method-specific-id</code> value SHOULD be globally unique by itself.
Any <a>DID</a> generated by the method MUST be globally unique.
      </p>

      <p>
If needed, a method-specific <a>DID scheme</a> MAY define multiple
<code>method-specific-id</code> formats. It is RECOMMENDED that a
method-specific <a>DID scheme</a> define as few <code>method-specific-id</code>
formats as possible.
      </p>

      <p>
The <code>method-specific-id</code> format MAY include colons. The use of
colons MUST comply syntactically with the <code>method-specific-id</code> ABNF
rule.
      </p>
      <p class="note" title="Colons in method-specific-id">
The meaning of colons in the <code>method-specific-id</code> is entirely
method-specific. Implementers are advised to avoid assuming any meanings or
behaviors associated with a colon that are generically applicable to all
<a>DID methods</a>.
      </p>

    </section>

    <section>
      <h2>Method Operations</h2>
      <p>
This section sets out the requirements for <a>DID method</a> specifications
with regards to operations that can be performed on a <a>DID document</a>.
      </p>
      <p>
Determining the authority of a party to carry out the operations is
method-specific. For example, a <a>DID method</a> MAY:
      </p>
      <ul>
        <li>
use the <a>verification methods</a> listed under <code>authentication</code> to
decide whether an update/deactivate operation is allowed; or
        </li>
        <li>
use other constructs in the <a>DID Document</a> to decide this, for example,
a verification method specified under <code>capabilityInvocation</code> could
be used to verify the invocation of a capability to update the DID Document.;
or
        </li>
        <li>
not use the <a>DID Document</a> at all to decide this, but have rules that are
"built into" the method.
        </li>
      </ul>

      <section>
        <h3>
Create
        </h3>

        <p>
The <a>DID method</a> specification MUST specify how a client creates a
<a>DID</a> and its associated <a>DID document</a> on the <a>verifiable data registry</a>,
including all cryptographic operations necessary to establish proof of control.
        </p>
      </section>

      <section>
        <h3>
Read/Verify
        </h3>

        <p>
The <a>DID method</a> specification MUST specify how a client uses a <a>DID</a>
to request a <a>DID document</a> from the <a>verifiable data registry</a>,
including how the client can verify the authenticity of the response.
        </p>
      </section>

      <section>
        <h3>
Update
        </h3>

        <p>
The <a>DID method</a> specification MUST specify how a client can update a
<a>DID document</a> on the <a>verifiable data registry</a>, including all cryptographic
operations necessary to establish proof of control, <em>or</em> state that
updates are not possible.
        </p>

        <p>
An update to a <a>DID</a> is any change, after creation, in the data used to
produce a <a>DID document</a>. <a>DID Method</a> implementers are responsible
for defining what constitutes an update, and what properties of the <a>DID
document</a> are supported by a given <a>DID method</a>. For example, an update
operation which replaces key material without changing it could be a valid
update that does not result in changes to the <a>DID document</a>.
        </p>
      </section>

      <section>
        <h3>
Deactivate
        </h3>

        <p>
The <a>DID method</a> specification MUST specify how a client can deactivate a
<a>DID</a> on the <a>verifiable data registry</a>, including all cryptographic
operations necessary to establish proof of deactivation, <em>or</em> state that
deactivation is not possible.
        </p>
      </section>
    </section>

    <section>
      <h2>
Security Requirements
      </h2>
      <p>
<a>DID method</a> specifications MUST include their own Security
Considerations sections. This section MUST consider all the requirements
mentioned in section 5 of [[RFC3552]] (page 27) for the <a>DID</a> operations
defined in the specification.
      </p>
      <p>
At least the following forms of attack MUST be considered: eavesdropping,
replay, message insertion, deletion, modification, and man-in-the-middle.
Potential denial of service attacks MUST be identified as well.
      </p>
      <p>
This section MUST discuss, per Section 5 of [[RFC3552]], residual risks (such as
the risks from compromise in a related protocol, incorrect implementation, or
cipher) after threat mitigation was deployed.
      </p>
      <p>
This section MUST provide integrity protection and update authentication for all
operations required by Section <a href="#method-operations"></a>.
      </p>
      <p>
If the technology involves authentication, particularly user-host
authentication, the security of the authentication method MUST be clearly
specified.
      </p>
      <p>
<a>DID methods</a> MUST discuss the policy mechanism by which <a>DIDs</a> are
proven to be uniquely assigned. A <a>DID</a> fits the functional definition of a
URN, as defined in [[RFC8141]]. That is, a <a>DID</a> is a persistent identifier
that is assigned once to a resource and never reassigned to a different
resource. This is particularly important in a security context because a
<a>DID</a> might be used to identify a specific party subject to a specific set
of authorization rights.
      </p>
      <p>
Method-specific endpoint authentication MUST be discussed. Where <a>DID
methods</a> make use of <a>DLTs</a> with varying network topology, sometimes
offered as <em>light node</em> or <em>
<a href="https://en.bitcoin.it/wiki/Thin_Client_Security">thin client</a></em>
implementations to reduce required computing resources, the security assumptions
of the topology available to implementations of the <a>DID method</a> MUST be
discussed.
      </p>
      <p>
If the protocol incorporates cryptographic protection mechanisms, the
<a>DID method</a> specification MUST clearly indicate which portions of the
data are protected and what the protections are, and SHOULD give an indication
to what sorts of attacks the cryptographic protection is susceptible.
For example, integrity only, confidentiality, endpoint authentication, and so
on.
      </p>
      <p>
Data which is to be held secret (keying material, random seeds, and so on)
SHOULD be clearly labeled.
      </p>
      <p>
Where <a>DID methods</a> make use of peer-to-peer computing resources, such as
with all known <a>DLTs</a>, the expected burdens of those resources SHOULD be
discussed in relation to denial of service.
      </p>
      <p>
<a>DID methods</a> that introduce new authentication <a>service endpoint</a>
types (see Section <a href="#service-endpoints"></a>) SHOULD consider the
security requirements of the supported authentication protocol.
      </p>

    </section>

    <section class='normative'>
      <h2>
Privacy Requirements
      </h2>

      <p>
<a>DID method</a> specifications MUST include their own Privacy
Considerations sections, if only to point to
<a href="#privacy-considerations"></a>.
      </p>

      <p>
The <a>DID method</a> specification's Privacy Considerations section MUST
discuss any subsection of section 5 of [[RFC6973]] that could apply in a
method-specific manner. The subsections to consider are: surveillance, stored
data compromise, unsolicited traffic, misattribution, correlation,
identification, secondary use, disclosure, exclusion.
      </p>
    </section>
  </section>

  <section class='normative'>
    <h1>
Resolution
    </h1>

    <p>
This section defines the inputs and outputs of <a>DID resolution</a> and <a>DID
URL dereferencing</a>. These functions are defined in an abstract way. Their
exact implementation is out of scope for this specification, but some
considerations for implementors are discussed in [[?DID-RESOLUTION]].
    </p>

    <p>
All conformant <a>DID resolvers</a> MUST implement the <a>DID resolution</a>
functions for at least one <a>DID method</a> and MUST be able to return a <a>DID
document</a> in  at least one conformant representation.
    </p>

    <section>
        <h2>
DID Resolution
        </h2>
        <p>
The <a>DID resolution</a> functions resolve a <a>DID</a> into a <a>DID
document</a> by using the "Read" operation of the applicable <a>DID method</a>.
(See <a href="#read-verify"></a>.) The details of how this process is
accomplished are outside the scope of this specification, but all conformant
implementations MUST implement two functions which have the following abstract forms:
        </p>

        <p><code>
resolve ( did, did-resolution-input-metadata ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; ( did-resolution-metadata, did-document, did-document-metadata )
        </code></p>

        <p><code>
resolveStream ( did, did-resolution-input-metadata ) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;-&gt; ( did-resolution-metadata, did-document-stream, did-document-metadata )
        </code></p>

        <p>
The input variables of these functions MUST be as follows:
        </p>

        <dl>
            <dt>
did
            </dt>
            <dd>
A conformant <a>DID</a> as a single string. This is the <a>DID</a> to resolve.
This input is REQUIRED.
            </dd>
            <dt>
did-resolution-input-metadata
            </dt>
            <dd>
A <a href="metadata-structure">metadata structure</a> consisting of input
options to the <code>resolve</code> and <code>resolveStream</code> functions in addition to the <code>did</code>
itself.
Properties defined by this specification are in <a href="#did-resolution-input-metadata-properties"></a>.
This input is REQUIRED, but the structure MAY be empty.
            </dd>
        </dl>

        <p>
The output variables of these functions MUST be as follows:
        </p>

        <dl>
            <dt>
did-resolution-metadata
            </dt>
            <dd>
A <a href="metadata-structure">metadata structure</a> consisting of values
relating to the results of the <a>DID resolution</a> process. This structure is
REQUIRED and MUST NOT be empty. This metadata typically changes between
invocations of the <code>resolve</code> and <code>resolveStream</code> functions as it represents data about the
resolution process itself.
Properties defined by this specification are in <a href="#did-resolution-metadata-properties"></a>.
If the resolution is successful, and if the <code>resolveStream</code> function was called, this structure MUST contain a <code>content-type</code> property containing the mime-type of the <code>did-document-stream</code> in this result.
If the resolution is not successful, this structure MUST contain an <code>error</code> property describing the error.
            </dd>
            <dt>
did-document
            </dt>
            <dd>
If the resolution is successful, and if the <code>resolve</code> function was called, this MUST be a <a>DID document</a> conforming to the abstract data model.
If the resolution is unsuccessful, this value MUST be empty.
            </dd>
            <dt>
did-document-stream
            </dt>
            <dd>
If the resolution is successful, and if the <code>resolveStream</code> function was called, this MUST be a byte stream of the resolved
<a>DID document</a> in one of the conformant <a href="#representations">representations</a>. The byte
stream MAY then be parsed by the caller of the <code>resolveStream</code> function
into a <a>DID document</a> abstract data model, which can in turn be validated
and processed. If the resolution is unsuccessful, this value MUST be an empty
stream.
            </dd>
            <dt>
did-document-metadata
            </dt>
            <dd>
If the resolution is successful, this MUST be a <a
href="metadata-structure">metadata structure</a>. This structure contains
metadata about the <a>DID document</a> contained in the <code>did-document</code> or
<code>did-document-stream</code>. This metadata typically does not change
between invocations of the <code>resolve</code> function unless the <a>DID
document</a> changes, as it represents data about the <a>DID document</a>. If
the resolution is unsuccessful, this output MUST be an empty <a
href="metadata-structure">metadata structure</a>.
Properties defined by this specification are in <a href="#did-document-metadata-properties"></a>.
            </dd>
        </dl>

        <p>
<a>DID resolver</a> implementations MUST NOT alter the signature of these
functions in any way. <a>DID resolver</a> implementations MAY map the
<code>resolve</code> and <code>resolveStream</code> functions to a method-specific internal function to perform
the actual <a>DID resolution</a> process. <a>DID resolver</a> implementations
MAY implement  and expose additional
functions with different signatures in addition to the <code>resolve</code>
function specified here.
        </p>

        <section>
            <h3>
DID Resolution Input Metadata Properties
            </h3>

            <p>
The possible properties within this structure and their possible values are defined by [[DID-SPEC-REGISTRIES]].
This specification defines the following common properties.
            </p>

            <dl>
                <dt>
accept
                </dt>
                <dd>
The MIME type of the caller's preferred <a href="#representations">representation</a> of the <a>DID document</a>. The <a>DID resolver</a> implementation
SHOULD use this value to determine the representation contained in the returned <code>did-document-stream</code> if such
a representation is supported and available. This property is OPTIONAL. It is only used if the <code>resolveStream</code>
function is called and MUST be ignored if the <code>resolve</code> function is called.
                </dd>
            </dl>
        </section>

        <section>
            <h3>
DID Resolution Metadata Properties
            </h3>

            <p>
The possible properties within this structure and their possible values are defined by [[DID-SPEC-REGISTRIES]].
This specification defines the following common properties.
            </p>

            <dl>
                <dt>
content-type
                </dt>
                <dd>
The MIME type of the returned <code>did-document-stream</code>.
This property is REQUIRED if resolution is successful and if the <code>resolveStream</code> function was called.
It MUST NOT be present if the <code>resolve</code> function was called.
The value of this property MUST be the MIME type of one of the conformant <a href="#representations">representations</a>.
The caller of the <code>resolveStream</code> function MUST use this value when determining how to
parse and process the <code>did-document-stream</code> returned by this function into a
<a>DID document</a> abstract data model.
                </dd>
                <dt>
error
                </dt>
                <dd>
The error code from the resolution process.
This property is REQUIRED when there is an error in the resolution process.
The value of this property is a single keyword string.
The possible property values of this field are defined by [[DID-SPEC-REGISTRIES]].
This specification defines the following error values:
                    <dl>
                        <dt>
invalid-did
                        </dt>
                        <dd>
The <a>DID</a> supplied to the <a>DID resolution</a> function does not
conform to valid syntax. (See <a href="#did-syntax"></a>.)
                        </dd>
                        <dt>
unauthorized
                        </dt>
                        <dd>
The caller is not authorized to resolve this <a>DID</a> with
this <a>DID resolver</a>.
                        </dd>
                        <dt>
not-found
                        </dt>
                        <dd>
The <a>DID resolver</a> was unable to return the <a>DID document</a>
resulting from this resolution request.
                        </dd>
                    </dl>
                </dd>
            </dl>

        </section>

        <section>
            <h3>
DID Document Metadata Properties
            </h3>

            <p>
The possible properties within this structure and their possible values are defined by [[DID-SPEC-REGISTRIES]].
This specification defines the following common properties.
            </p>

        </section>

    </section>

    <section>
        <h2>
DID URL Dereferencing
        </h2>
    </section>

    <section>
        <h2>
Metadata Structure
        </h2>
    </section>

  </section>

  <section class="informative">
    <h1>
Security Considerations
    </h1>

    <p class="note" title="Note to implementers">
During the Working Draft stage, this section focuses on security topics that
should be important in early implementations. The editors are seeking feedback
on threats and threat mitigations that should be reflected in this section or
elsewhere in the spec. <a>DIDs</a> are designed to operate under the general
Internet threat model used by many IETF standards. We assume uncompromised
endpoints, but anticipate that messages could be read or corrupted on the
network. Protecting against an attack when a system is compromised requires
external key-signing hardware (see Section <a
href="#key-revocation-and-recovery"></a>).
    </p>

    <section>
      <h2>
Choosing DID Resolvers
      </h2>

      <p>
The DID Method Registry (see [[?DID-SPEC-REGISTRIES]] is an informative list of <a>DID method</a> names
and their corresponding <a>DID method</a> specifications. Implementors need to
bear in mind that there is no central authority to mandate which
<a>DID method</a> specification is to be used with any specific
<a>DID method</a> name, but can use the DID Method Registry to make an
informed decision when choosing which <a>DID resolver</a> implementations to
use.
      </p>
    </section>

    <section>
      <h2>
Binding of Identity
      </h2>

      <p>
The following sections describe binding identities to <a>DIDs</a> and
<a>DID documents</a>.
      </p>

      <section>
        <h3>
Proving Control of a DID and DID Document
        </h3>

        <p>
Signatures and <a>verifiable timestamps</a> allow <a>DID documents</a> to be cryptographically
verifiable.
        </p>

        <p>
By itself, a verified signature on a self-signed <a>DID document</a> does not
prove control of a <a>DID</a>. It only proves that the:
        </p>

        <ul>
          <li>
<a>DID document</a> was not tampered with since it was timestamped.
          </li>

          <li>
<a>DID controller(s)</a> controlled the private key used for the signature at
the time the timestamp was created.
          </li>
        </ul>

        <p>
Proving control of a <a>DID</a>, that is, the binding between the <a>DID</a> and
the <a>DID document</a> that describes it, requires a two step process:
        </p>

        <ol start="1">
          <li>
Resolving the <a>DID</a> to a <a>DID document</a> according to its
<a>DID method</a> specification.
          </li>

          <li>
Verifying that the <code>id</code> property of the resulting <a>DID document</a>
matches the <a>DID</a> that was resolved.
          </li>
        </ol>

        <p>
It should be noted that this process proves control of a <a>DID</a> and
<a>DID document</a> regardless of whether the <a>DID document</a> is signed.
        </p>

        <p>
Signatures on <a>DID documents</a> are optional. <a>DID method</a>
specifications SHOULD explain and specify their implementation if applicable.
        </p>
      </section>

      <section>
        <h3>
Proving Control of a Public Key
        </h3>

        <p>
There are two methods for proving control of the private key corresponding to a
<a>public key description</a> in the <a>DID document</a>: static and dynamic.
        </p>

        <p>
The static method is to sign the <a>DID document</a> with the private key. This
proves control of the private key at a time no later than the
<a>DID document</a> was registered. If the <a>DID document</a> is not signed,
control of a public key described in the <a>DID document</a> can still be proven
dynamically as follows:
        </p>

        <ol start="1">
          <li>
Send a challenge message containing a <a>public key description</a> from the
<a>DID document</a> and a nonce to an appropriate <a>service endpoint</a>
described in the <a>DID document</a>.
          </li>

          <li>
Verify the signature of the response message against the
<a>public key description</a>.
          </li>
        </ol>
      </section>

      <section>
        <h3>
Authentication and Verifiable Claims
        </h3>

        <p>
A <a>DID</a> and <a>DID document</a> do not inherently carry any
<a href="https://en.wikipedia.org/wiki/Personally_identifiable_information">
  PII</a>
(personally-identifiable information). The process of binding a <a>DID</a> to
something in the real world, such as a person or a company, for example with
credentials with the same subject as that <a>DID</a>, is out of scope for this
specification. For more information, see the [[VC-DATA-MODEL]] instead.
        </p>
      </section>
    </section>

    <section>
      <h2>
Authentication Service Endpoints
      </h2>

      <p>
If a <a>DID document</a> publishes a <a>service endpoint</a> intended for
authentication or authorization of the <a>DID subject</a> (see Section <a
href="#service-endpoints"></a>), it is the responsibility of the <a>service
endpoint</a> provider, subject, or relying party to comply with the requirements
of the authentication protocols supported at that <a>service endpoint</a>.
      </p>
    </section>

    <section>
      <h2>
Non-Repudiation
      </h2>

      <p>
Non-repudiation of <a>DIDs</a> and <a>DID document</a> updates is supported
under the assumption that the subject:
      </p>

      <ul>
        <li>
Is monitoring for unauthorized updates (see Section
<a href="#notification-of-did-document-changes"></a>).
        </li>
        <li>
Has had adequate opportunity to revert malicious updates according to the
access control mechanism for the <a>DID method</a> (see Section
<a href="#authentication"></a>).
        </li>
      </ul>

      <p>
Non-repudiation is further supported if timestamps are included (see Sections
<a href="#created"></a> and <a href="#updated"></a>) and the target <a>DLT</a>
system supports timestamps.
      </p>
    </section>

    <section>
      <h2>
Notification of DID Document Changes
      </h2>

      <p>
One mitigation against unauthorized changes to a <a>DID document</a> is
monitoring and actively notifying the <a>DID subject</a> when there are changes.
This is analogous to helping prevent account takeover on conventional
username/password accounts by sending password reset notifications to the email
addresses on file.
      </p>
      <p>
In the case of a <a>DID</a>, there is no intermediary registrar or account
provider to generate such notifications. However, if the <a>verifiable data registry</a>
on which the <a>DID</a> is registered directly supports change notifications,
a subscription service can be offered to <a>DID controllers</a>. Notifications
could be sent directly to the relevant <a>service endpoints</a> listed in an
existing <a>DID</a>.
      </p>
      <p>
If a <a>DID controller</a> chooses to rely on a third-party monitoring service
(other than the <a>verifiable data registry</a> itself), this introduces another
vector of attack.
      </p>
    </section>

    <section>
      <h2>
Key and Signature Expiration
      </h2>

      <p>
In a <a>decentralized identifier</a> architecture, there are no centralized
authorities to enforce key or signature expiration policies. Therefore
<a>DID resolvers</a> and other client applications need to validate that keys
were not expired at the time they were used. Because some use cases might have
legitimate reasons why already-expired keys can be extended, make sure a key
expiration does not prevent any further use of the key, and implementations
of a resolver ought to be compatible with such extension behavior.
      </p>
    </section>

    <section>
      <h2>
Key Revocation and Recovery
      </h2>

      <p>
Section <a href="#method-operations"></a> specifies the <a>DID</a> operations to
be supported by a <a>DID method</a> specification, including deactivation of a
<a>DID document</a> by replacing it with an updated <a>DID document</a>. It is
also up to the <a>DID method</a> to define how revocation of cryptographic keys
might occur. Additionally, <a>DID method</a> specifications are also expected
to enable support for a quorum of trusted parties to enable key recovery. Some
of the facilities to do so are suggested in Section
<a href="#authorization-and-delegation"></a>. Not all <a>DID method</a>
specifications will recognize control from <a>DIDs</a> registered using other
<a>DID methods</a> and they might restrict third-party control to <a>DIDs</a>
that use the same method. Access control and key recovery in a <a>DID method</a>
specification can also include a time lock feature to protect against key
compromise by maintaining a second track of control for recovery. Further
specification of this type of control is a matter for future work.
</p>
    </section>

    <section>
      <h2>
The Role of Human-Friendly Identifiers
      </h2>

      <p>
<a>DIDs</a> achieve global uniqueness without the need for a central
registration authority. This comes, however, at the cost of human memorability.
The algorithms capable of generating globally unique identifiers automatically
produce random strings of characters that have no human meaning. This
demonstrates the axiom about identifiers described in
<a href="https://en.wikipedia.org/wiki/Zooko%27s_triangle">Zooko's Triangle</a>:
"human-meaningful, decentralized, secure &mdash; pick any two".
      </p>

      <p>
There are of course many use cases where it is desirable to
discover a <a>DID</a> when starting from a human-friendly identifier. For
example, a natural language name, a domain name, or a conventional address for
a <a>DID controller</a>, such as a mobile telephone number, email address,
Twitter handle, or blog URL. However, the problem of mapping human-friendly
identifiers to <a>DIDs</a> (and doing so in a way that can be verified and
trusted) is outside the scope of this specification.
      </p>

      <p>
Solutions to this problem (and there are many) should be defined in separate
specifications that reference this specification. It is strongly recommended
that such specifications carefully consider the:
      </p>

      <ul>
        <li>
Numerous security attacks based on deceiving users about the true human-friendly
identifier for a target entity.
        </li>
        <li>
Privacy consequences of using human-friendly identifiers that are inherently
correlatable, especially if they are globally unique.
        </li>
      </ul>

      <p class="note">
A draft specification for discovering a <a>DID</a> from domain names and email
addresses using DNS lookups is available at [[?DNS-DID]].
      </p>
    </section>

    <section>
        <h2>
Immutability
        </h2>

        <p>
Many cybersecurity abuses hinge on exploiting gaps between reality and the
assumptions of rational, good-faith actors. Like any ecosystem, the <a>DID</a>
ecosystem has some potential for this to occur. Because this specification is
focused on a data model instead of a protocol, it offers no opinion about many
aspects of how that model is put to use. However, individual <a>DID methods</a>
might want to consider constraints that would eliminate behaviors or semantics
they do not need. The more <em>locked down</em> a <a>DID method</a> is, while
providing the same set of features, the less it can be manipulated by malicious
actors.
        </p>
        <p>
As an example, consider the flexibility that the data model offers with respect
to updating. A single edit to a <a>DID document</a> can change anything and
everything except the root <code>id</code> property of the document. And any
individual JSON object in the data model can change all of its properties except
its <code>id</code>. But is it actually desirable for a <a>service endpoint</a>
to change its <code>type</code> after it is defined? Or for a key to change its
value? Or would it be better to require a new <code>id</code> when certain
fundamental properties of an object change? Malicious takeovers of a web site
often aim for an outcome where the site keeps its identifier (the host name),
but gets subtle, dangerous changes underneath. If certain properties of the site
were required by the specification to be immutable (for example, the
<a target="_blank"
  href="https://en.wikipedia.org/wiki/Autonomous_system_(Internet)">ASN</a>
associated with its IP address), such attacks might be much harder and more
expensive to carry out, and anomaly detection would be easier.
        </p>
        <p>
The notion that immutability provides some cybersecurity benefits is
particularly relevant because of caching. For <a>DID methods</a> tied to a
global source of truth, a direct, just-in-time lookup of the latest version of a
<a>DID document</a> is always possible. However, it seems likely that layers of
cache might eventually sit between a client and that source of truth. If they
do, believing the attributes of an object in the <a>DID document</a> to have a
given state, when they are actually subtly different, might invite exploits.
This is particularly true if some lookups are of a full <a>DID document</a>, and
others are of partial data, where the larger context is assumed.
        </p>
    </section>

    <section>
      <h2>
Encrypted Data in DID Documents
      </h2>
      <p>
DID documents are typically publicly available. Encryption algorithms have been
known to fail due to advances in cryptography and computing power. Implementers
are advised to assume that any encrypted data placed in a <a>DID document</a>
might eventually be made available in clear text to the same audience to which
the encrypted data is available.
      </p>
      <p>
Encrypting all or parts of DID documents is <em>not</em> an appropriate means to
protect data in the long term. Similarly, placing encrypted data in DID
documents is not an appropriate means to include personally identifiable
information.
      </p>
      <p>
Given the caveats above, if encrypted data is included in a DID document,
implementers are advised to not encrypt with the public keys of entities that do
not wish to be correlated with the <a>DID</a>.
      </p>

    </section>

  </section>

  <section class="informative">
    <h1>
Privacy Considerations
    </h1>

    <p>
It is critically important to apply the principles of Privacy by Design
to all aspects of the <a>decentralized identifier</a> architecture, because
<a>DIDs</a> and <a>DID documents</a> are, by design, administered directly by
the <a>DID controller(s)</a>. There is no registrar, hosting company, or other
intermediate service provider to recommend or apply additional privacy
safeguards. The authors of this specification have applied all seven Privacy by
Design principles throughout its development. For example, privacy in this
specification is preventative not remedial, and privacy is an embedded default.
Furthermore, the <a>decentralized identifier</a> architecture by itself embodies
principle #7, "Respect for user privacy &mdash; keep it user-centric."
    </p>

    <p>
This section lists additional privacy considerations that implementers,
delegates, and <a>DID subjects</a> should keep in mind.
    </p>

    <section>
      <h2>
Keep Personally-Identifiable Information (PII) Private
      </h2>

      <p>
If a <a>DID method</a> specification is written for a public <a>verifiable data
registry</a> where all <a>DIDs</a> and <a>DID documents</a> are publicly
available, it is <em>critical</em> that <a>DID documents</a> contain no
personal data. All personal data should be kept behind <a>service
endpoints</a> under the control of the <a>DID subject</a>. Additional due
diligence should be taken around the use of URLs in service endpoints as well
to prevent leakage of unintentional personal data or correlation within a URL
of a service endpoint. For example, a URL that contains a username is likely
dangerous to include in a <a>DID Document</a> because the username is likely
to be human-meaningful in a way that can unintentionally reveal information
that the <a>DID subject</a> did not consent to sharing. With this privacy
architecture, personal data can be exchanged on a private, peer-to-peer basis
using communications channels identified and secured by <a>public key
descriptions</a> in <a>DID documents</a>. This also enables <a>DID
subjects</a> and relying parties to implement the <a
href="https://en.wikipedia.org/wiki/General_Data_Protection_Regulation">GDPR</a>
<a href="https://en.wikipedia.org/wiki/Right_to_be_forgotten">right to be
forgotten</a>, because no personal data is written to an immutable
<a>distributed ledger</a>.
      </p>
    </section>

    <section>
      <h2>
DID Correlation Risks and Pseudonymous DIDs
      </h2>

      <p>
Like any type of globally unique identifier, <a>DIDs</a> might be used for
correlation. <a>DID controllers</a> can mitigate this privacy risk by using
pairwise unique <a>DIDs</a>, that is, sharing a different private <a>DID</a> for
every relationship. In effect, each <a>DID</a> acts as a pseudonym. A
pseudonymous <a>DID</a> need only be shared with more than one party when
the <a>DID subject</a> explicitly authorizes correlation between those parties.
If pseudonymous <a>DIDs</a> are the default, then the only need for a public
<a>DID</a> (a <a>DID</a> published openly or shared with a large number of
parties) is when the <a>DID subject</a> explicitly desires public
identification.
      </p>
    </section>

    <section>
      <h2>
DID Document Correlation Risks
      </h2>

      <p>
The anti-correlation protections of pseudonymous <a>DIDs</a> are easily defeated
if the data in the corresponding <a>DID documents</a> can be correlated. For
example, using same <a>public key descriptions</a> or bespoke
<a>service endpoints</a> in multiple <a>DID documents</a> can provide as much
correlation information as using the same <a>DID</a>. Therefore the
<a>DID document</a> for a pseudonymous <a>DID</a> also needs to use pairwise
unique public keys.

It might seem natural to also use pairwise unique <a>service endpoints</a> in
the <a>DID document</a> for a pseudonymous <a>DID</a>. However, unique endpoints
allow all traffic between two <a>DIDs</a> to be isolated perfectly into unique
buckets, where timing correlation and similar analysis is easy. Therefore, a
better strategy for endpoint privacy might be to share an endpoint among
thousands or millions of <a>DIDs</a> controlled by many different subjects.
      </p>
    </section>

    <section>
      <h2>
Herd Privacy
      </h2>

      <p>
When a <a>DID subject</a> is indistinguishable from others in the herd, privacy
is available. When the act of engaging privately with another party
is by itself a recognizable flag, privacy is greatly diminished. <a>DIDs</a>
and <a>DID methods</a> need to work to improve herd privacy, particularly for
those who legitimately need it most. Choose technologies and human interfaces
that default to preserving anonymity and pseudonymity. To reduce
<a href="https://en.wikipedia.org/wiki/Device_fingerprint">
  digital fingerprints</a>,
share common settings across client implementations, keep negotiated options to
a minimum on wire protocols, use encrypted transport layers, and pad messages to
standard lengths.
      </p>
    </section>
  </section>

  <section class="appendix">
    <h1>Current Issues</h1>

    <p>
The list of issues below are under active discussion and are likely to
result in changes to this specification.
    </p>

    <div class="issue" data-number="5">Where will the DID contexts(s) live?</div>
    <div class="issue" data-number="8">Leverage RFC7518 to specify cryptographic algorithms</div>
    <div class="issue" data-number="9">Replace RsaSignature2017 by a standard JWA signature</div>
    <div class="issue" data-number="10">Explain RsaSignature2018</div>
    <div class="issue" data-number="14">Standardize the key revocation list </div>
    <div class="issue" data-number="23">publicKeyJwk, publicKeyHex, publicKeyBase64, publicKeyBase58 missing from context.</div>
    <div class="issue" data-number="33">Cheap DIDs and the option to migrate DIDs between ledgers using standard DID Deprecation Registries</div>
    <div class="issue" data-number="36">Details on the use of method-specific DID parameters</div>
    <div class="issue" data-number="55">Add support for ethereumAddress public key type in @context</div>
    <div class="issue" data-number="57">Clarification of other verification methods in authentication section missing</div>
    <div class="issue" data-number="58">Registry handling</div>
    <div class="issue" data-number="65">Does DID Document metadata belong in the Document?</div>
    <div class="issue" data-number="72">Privacy Considerations - Specifically call out GDPR</div>
    <div class="issue" data-number="75">tracking revocation of public keys</div>
    <div class="issue" data-number="85">Syntactially differentiate data about the DID versus application data</div>
    <div class="issue" data-number="92">Add CBOR a valid type of DID document syntax similar to JSON and on par with JSON-LD</div>
    <div class="issue" data-number="94">Create DID explainer</div>
    <div class="issue" data-number="95">Document Structure</div>
    <div class="issue" data-number="104">Horizontal Review: Internationalization self test</div>
    <div class="issue" data-number="105">Horizontal Review: Accessibility self test</div>
    <div class="issue" data-number="118">Specification needs to be compliant with WCAG 2.0</div>
    <div class="issue" data-number="119">Horizontal Review: offer review opportunity to TAG</div>
    <div class="issue" data-number="122">When is a DID subject not a DID controller (if ever)?</div>
    <div class="issue" data-number="137">Should the DID parameters be normative in the spec?</div>
    <div class="issue" data-number="151">Include discussion of eIDAS levels-of-assurance</div>
    <div class="issue" data-number="154">Decoupling DID Core spec from LD-Proof / LDS specs</div>
    <div class="issue" data-number="163">Uses of terms defined in the specification should be links to their definitions</div>
    <div class="issue" data-number="165">What are entityship and start-of-authority (SOA) problems?</div>
    <div class="issue" data-number="169">Replace registries administered community groups with registries established by this specification</div>
    <div class="issue" data-number="170">Public key "id" and "type" members duplicate JWK "kid" and "kty" members</div>
    <div class="issue" data-number="171">Add public key examples using JWKs</div>
    <div class="issue" data-number="174">Underspecified semantics of "updated" property</div>
    <div class="issue" data-number="176">Unsubstantiated statement about protecting against attacks when compromised</div>
    <div class="issue" data-number="178">Underspecified statement on combining timestamps with signatures</div>
    <div class="issue" data-number="185">Supported ciphers in a DID document</div>
    <div class="issue" data-number="190">What is being discussed in issue 4 (clarification of TERMX via use-cases, spec pointers, and PR)</div>
    <div class="issue" data-number="195">Unclear which verification methods are authorized for did document operations </div>
    <div class="issue" data-number="198">Add sections on DID Resolution</div>
    <div class="issue" data-number="199">Clarification on what DIDs might identify</div>
    <div class="issue" data-number="202">JSON-LD Contexts in Registry</div>
    <div class="issue" data-number="203">Define DID Document Metadata</div>
    <div class="issue" data-number="204">Define terminology for properties and values</div>
    <div class="issue" data-number="205">How to treat unknown properties</div>
    <div class="issue" data-number="207">Add section on extensibility and conformance</div>
    <div class="issue" data-number="208">IETF did+ld+json media type registration</div>
    <div class="issue" data-number="236">publicKeyHex format unused by spec currently</div>
    <div class="issue" data-number="240">Should did-core restrict the use of JWK?</div>
    <div class="issue" data-number="248">Need term for relying party</div>
    <div class="issue" data-number="249">How to mitigate the single source of failure wrt/ "Trust into the Universal Resolver"?</div>
    <div class="issue" data-number="253">Added DID resolution and dereferencing contracts.</div>
    <div class="issue" data-number="258">List of early implementations conforming to spec?</div>
    <div class="issue" data-number="259">DIDs and JOSE: publicKey.id and publicKey.publicKeyJwk.kid</div>
    <div class="issue" data-number="260">Clear explanation on how can A DID have more than one controller</div>
    <div class="issue" data-number="261">Definition of the term "client" in regard to SSI principles</div>
    <div class="issue" data-number="266">Should DID support self-signed certificates?</div>
    <div class="issue" data-number="267">Put key points up front</div>
    <div class="issue" data-number="268">What degree should proof purposes be defined for specific application layer usages?</div>
    <div class="issue" data-number="269">transfer of controllership and it's intersection with the subject of an identifier</div>
    <div class="issue" data-number="270">did parameter equivilance</div>
    <div class="issue" data-number="272">Remove all unspecified properties/functionality from the spec</div>
    <div class="issue" data-number="273">invert mapping between proof purposes and verification methods?</div>
    <div class="issue" data-number="274">Ambiguity around necessity of populated top-level DID Document 'id' property</div>
    <div class="issue" data-number="280">Remove uses of publicKeyHex </div>
    <div class="issue" data-number="281">Specifications needed for supported key representations publicKeyJwk, publcKeyPem, and publicKeyBase58</div>
    <div class="issue" data-number="282">Added CBOR section </div>
    <div class="issue" data-number="283">Verification method block should be a first citizen like public keys</div>
    <div class="issue" data-number="289">Should DID Methods expose Proof Purposes for DID Operations?</div>
    <div class="issue" data-number="291">PING Horizontal Review</div>
    <div class="issue" data-number="292">Horizontal Review Tracking</div>
    <div class="issue" data-number="293">Remove `proof`</div>
    <div class="issue" data-number="294">Create a seperate top level block for defining proof purposes</div>
    <div class="issue" data-number="295">Define simple type-less resolution function</div>
    <div class="issue" data-number="296">Define resolution function with data types</div>
    <div class="issue" data-number="297">Define resolution function with data types and property values</div>
    <div class="issue" data-number="298">Define resolution function with data types, property values, and simple metadata structures</div>
    <div class="issue" data-number="299">Define resolution function with data types, property values, and full metadata structures</div>
    <div class="issue" data-number="300">Define resolution function with data types, property values, and full metadata structures, without transformation</div>

  </section>

<section class="appendix">
    <h1>
IANA Considerations
    </h1>

    <p>
This section will be submitted to the Internet Engineering Steering Group
(IESG) for review, approval, and registration with IANA when this specification
becomes a W3C Proposed Recommendation.
    </p>

    <section>
      <h2>application/did+json</h2>
      <dl>
        <dt>Type name:</dt>
        <dd>application</dd>
        <dt>Subtype name:</dt>
        <dd>did+json</dd>
        <dt>Required parameters:</dt>
        <dd>None</dd>
        <dt>Optional parameters:</dt>
        <dd>None</dd>
        <dt>Encoding considerations:</dt>
        <dd>
See <a data-cite="RFC8259#section-11">RFC&nbsp;8259, section 11</a>.
        </dd>
        <dt>Security considerations:</dt>
        <dd>
See <a data-cite="RFC8259#section-12">RFC&nbsp;8259, section 12</a> [[RFC8259]].
        </dd>
        <dt>Interoperability considerations:</dt>
        <dd>Not Applicable</dd>
        <dt>Published specification:</dt>
        <dd>http://www.w3.org/TR/did-core/</dd>
        <dt>Applications that use this media type:</dt>
        <dd>
Any application that requires an identifier that is decentralized, persistent,
cryptographically verifiable, and resolvable. Applications typically consist of
cryptographic identity systems, decentralized networks of devices, and
websites that issue or verify W3C Verifiable Credentials.
        </dd>
        <dt>Additional information:</dt>
        <dd>
          <dl>
            <dt>Magic number(s):</dt>
            <dd>Not Applicable</dd>
            <dt>File extension(s):</dt>
            <dd>.did</dd>
            <dt>Macintosh file type code(s):</dt>
            <dd>TEXT</dd>
          </dl>
        </dd>
        <dt>Person &amp; email address to contact for further information:</dt>
        <dd>Ivan Herman &lt;ivan@w3.org&gt;</dd>
        <dt>Intended usage:</dt>
        <dd>Common</dd>
        <dt>Restrictions on usage:</dt>
        <dd>None</dd>
        <dt>Author(s):</dt>
        <dd>
Drummond Reed, Manu Sporny, Markus Sabadello, Dave Longley, Christopher Allen
        </dd>
        <dt>Change controller:</dt>
        <dd>W3C</dd>
      </dl>

      <p>
Fragment identifiers used with
<a href="#application-did-json">application/did+json</a> are treated
according to the rules defined in
<a data-cite="DID-CORE#fragment">DID Core v1.0, Fragment</a> [[DID-CORE]].
      </p>
    </section>

    <section>
      <h2>application/did+ld+json</h2>
      <dl>
        <dt>Type name:</dt>
        <dd>application</dd>
        <dt>Subtype name:</dt>
        <dd>did+ld+json</dd>
        <dt>Required parameters:</dt>
        <dd>None</dd>
        <dt>Optional parameters:</dt>
        <dd>None</dd>
        <dt>Encoding considerations:</dt>
        <dd>
See <a data-cite="RFC8259#section-11">RFC&nbsp;8259, section 11</a>.
        </dd>
        <dt>Security considerations:</dt>
        <dd>
See <a data-cite="JSON-LD11#security">JSON-LD 1.1, Security Considerations</a>
[[JSON-LD11]].
        </dd>
        <dt>Interoperability considerations:</dt>
        <dd>Not Applicable</dd>
        <dt>Published specification:</dt>
        <dd>http://www.w3.org/TR/did-core/</dd>
        <dt>Applications that use this media type:</dt>
        <dd>
Any application that requires an identifier that is decentralized, persistent,
cryptographically verifiable, and resolvable. Applications typically consist of
cryptographic identity systems, decentralized networks of devices, and
websites that issue or verify W3C Verifiable Credentials.
        </dd>
        <dt>Additional information:</dt>
        <dd>
          <dl>
            <dt>Magic number(s):</dt>
            <dd>Not Applicable</dd>
            <dt>File extension(s):</dt>
            <dd>.did</dd>
            <dt>Macintosh file type code(s):</dt>
            <dd>TEXT</dd>
          </dl>
        </dd>
        <dt>Person &amp; email address to contact for further information:</dt>
        <dd>Ivan Herman &lt;ivan@w3.org&gt;</dd>
        <dt>Intended usage:</dt>
        <dd>Common</dd>
        <dt>Restrictions on usage:</dt>
        <dd>None</dd>
        <dt>Author(s):</dt>
        <dd>
Drummond Reed, Manu Sporny, Markus Sabadello, Dave Longley, Christopher Allen
        </dd>
        <dt>Change controller:</dt>
        <dd>W3C</dd>
      </dl>

      <p>
Fragment identifiers used with
<a href="#application-did-ld-json">application/did+ld+json</a> are treated
according to the rules associated with the
<a data-cite="JSON-LD11#iana-considerations">JSON-LD 1.1: application/ld+json
media type</a> [[JSON-LD11]].
      </p>
    </section>

    <section>
      <h2>application/did+cbor</h2>
      <dl>
        <dt>Type name:</dt>
        <dd>application</dd>
        <dt>Subtype name:</dt>
        <dd>did+cbor</dd>
        <dt>Required parameters:</dt>
        <dd>None</dd>
        <dt>Optional parameters:</dt>
        <dd>None</dd>
        <dt>Encoding considerations:</dt>
        <dd>
See <a data-cite="RFC7049#section-3.9">RFC&nbsp;7049, section 4.2</a>.
        </dd>
        <dt>Security considerations:</dt>
        <dd>
See <a data-cite="RFC7049#section-10">RFC&nbsp;7049, section 10</a> [[RFC7049]].
        </dd>
        <dt>Interoperability considerations:</dt>
        <dd>Not Applicable</dd>
        <dt>Published specification:</dt>
        <dd>http://www.w3.org/TR/did-core/</dd>
        <dt>Applications that use this media type:</dt>
        <dd>
Any application that requires an identifier that is decentralized, persistent,
cryptographically verifiable, and resolvable. Applications typically consist of
cryptographic identity systems, decentralized networks of devices, and
websites that issue or verify W3C Verifiable Credentials.
        </dd>
        <dt>Additional information:</dt>
        <dd>
          <dl>
            <dt>Magic number(s):</dt>
            <dd>Not Applicable</dd>
            <dt>File extension(s):</dt>
            <dd>.did</dd>
            <dt>Macintosh file type code(s):</dt>
            <dd>TEXT</dd>
          </dl>
        </dd>
        <dt>Person &amp; email address to contact for further information:</dt>
        <dd>Ivan Herman &lt;ivan@w3.org&gt;</dd>
        <dt>Intended usage:</dt>
        <dd>Common</dd>
        <dt>Restrictions on usage:</dt>
        <dd>None</dd>
        <dt>Author(s):</dt>
        <dd>Drummond Reed, Manu Sporny, Markus Sabadello, Dave Longley, Christopher Allen, Jonathan Holt</dd>
        <dt>Change controller:</dt>
        <dd>W3C</dd>
      </dl>

       <p>
Fragment identifiers used with
<a href="#application-did-json">application/did+cbor</a> are treated
according to the rules defined in
<a data-cite="DID-CORE#fragment">DID Core v1.0, Fragment</a> [[DID-CORE]].
      </p>
    </section>

     <section>
      <h2>application/did+dag+cbor</h2>
      <dl>
        <dt>Type name:</dt>
        <dd>application</dd>
        <dt>Subtype name:</dt>
        <dd>did+dag+cbor</dd>
        <dt>Required parameters:</dt>
        <dd>None</dd>
        <dt>Optional parameters:</dt>
        <dd>None</dd>
        <dt>Encoding considerations:</dt>
        <dd>
See <a data-cite="RFC7049#section-4.2">RFC&nbsp;7049, section 4.2</a>.
        </dd>
        <dt>Security considerations:</dt>
        <dd>
See <a data-cite="RFC7049#section-10">RFC&nbsp;7049, section 10</a> [[RFC7049]].
        </dd>
        <dt>Interoperability considerations:</dt>
        <dd>Not Applicable</dd>
        <dt>Published specification:</dt>
        <dd>http://www.w3.org/TR/did-core/</dd>
        <dt>Applications that use this media type:</dt>
        <dd>
Any application that requires an identifier that is decentralized, persistent,
cryptographically verifiable, and resolvable. Applications typically consist of
cryptographic identity systems, decentralized networks of devices, and
websites that issue or verify W3C Verifiable Credentials.
        </dd>
        <dt>Additional information:</dt>
        <dd>
          <dl>
            <dt>Magic number(s):</dt>
            <dd>Not Applicable</dd>
            <dt>File extension(s):</dt>
            <dd>.did</dd>
            <dt>Macintosh file type code(s):</dt>
            <dd>TEXT</dd>
          </dl>
        </dd>
        <dt>Person &amp; email address to contact for further information:</dt>
        <dd>Ivan Herman &lt;ivan@w3.org&gt;</dd>
        <dt>Intended usage:</dt>
        <dd>Common</dd>
        <dt>Restrictions on usage:</dt>
        <dd>None</dd>
        <dt>Author(s):</dt>
        <dd>Drummond Reed, Manu Sporny, Markus Sabadello, Dave Longley, Christopher Allen, Jonathan Holt</dd>
        <dt>Change controller:</dt>
        <dd>W3C</dd>
      </dl>

       <p>
Fragment identifiers used with
<a href="#application-did-json">application/did+cbor</a> are treated
according to the rules defined in
<a data-cite="DID-CORE#fragment">DID Core v1.0, Fragment</a> [[DID-CORE]].
      </p>
    </section>



  </section>

</body>
</html>
